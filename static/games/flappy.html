<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Flappy Bird</title><link rel="stylesheet" href="/games/common.css"><style>.wrap{max-width:520px}.stage{position:relative}.score{margin:8px 0}canvas{width:100%;max-width:480px;height:auto;background:linear-gradient(#7dd3fc,#e0f2fe);border:1px solid #334155;border-radius:10px;touch-action:none}</style></head><body><div class="wrap"><div class="top"><h2>Flappy Bird（小新主题）</h2><a href="/games/">返回</a></div><div class="score">分数：<b id="s">0</b>｜最高：<b id="b">0</b></div><div class="stage"><canvas id="c" width="480" height="640"></canvas></div><p><button id="start">开始/重开</button></p></div><script src="/games/common.js"></script><script>const c=document.getElementById('c'),ctx=c.getContext('2d');const W=480,H=640,bird={x:112,y:260,w:46,h:46,vy:0};let g=0.45,jump=-7.2,pipes=[],t=0,score=0,run=false,best=GameStore.getBest('best_flappy');b.textContent=best;const sprite=new Image();sprite.src='/games/assets/shinchan.webp';function reset(){bird.y=260;bird.vy=0;pipes=[];t=0;score=0;s.textContent=0;run=true}function flap(){if(!run)return;bird.vy=jump}function addPipe(){const gap=150,top=90+Math.random()*280;pipes.push({x:530,top,gap,passed:false,w:72})}function drawCanPipe(x,y,w,h){ctx.fillStyle='#dc2626';ctx.fillRect(x,y,w,h);ctx.fillStyle='#fef2f2';for(let i=0;i<5;i++){const yy=y+14+i*(h/5);ctx.beginPath();ctx.moveTo(x+6,yy);ctx.quadraticCurveTo(x+w/2,yy+8,x+w-6,yy);ctx.strokeStyle='rgba(255,255,255,.8)';ctx.lineWidth=2;ctx.stroke()}ctx.fillStyle='#991b1b';ctx.fillRect(x-2,y,w+4,10);ctx.fillRect(x-2,y+h-10,w+4,10)}function hit(a,p){return a.x+a.w>p.x&&a.x<p.x+p.w&&(a.y<p.top||a.y+a.h>p.top+p.gap)}function over(){run=false;if(score>best){best=score;GameStore.setBest('best_flappy',best);b.textContent=best}}function drawBird(){const tilt=Math.max(-0.5,Math.min(0.8,bird.vy*0.05));ctx.save();ctx.translate(bird.x+bird.w/2,bird.y+bird.h/2);ctx.rotate(tilt);if(sprite.complete){ctx.drawImage(sprite,-bird.w/2,-bird.h/2,bird.w,bird.h)}else{ctx.fillStyle='#f59e0b';ctx.fillRect(-bird.w/2,-bird.h/2,bird.w,bird.h)}ctx.restore()}function loop(){ctx.clearRect(0,0,W,H);if(run){t++;bird.vy+=g;bird.y+=bird.vy;if(t%95===0)addPipe();if(bird.y<0||bird.y>H-bird.h)over();pipes.forEach(p=>{p.x-=2.25;drawCanPipe(p.x,0,p.w,p.top);drawCanPipe(p.x,p.top+p.gap,p.w,H-(p.top+p.gap));if(!p.passed&&p.x+p.w<bird.x){p.passed=true;score++;s.textContent=score}if(hit(bird,p))over()});pipes=pipes.filter(p=>p.x>-100)}drawBird();requestAnimationFrame(loop)}window.addEventListener('keydown',e=>{if(e.code==='Space'){e.preventDefault();flap()}});c.addEventListener('pointerdown',flap);start.onclick=reset;reset();loop();</script></body></html>