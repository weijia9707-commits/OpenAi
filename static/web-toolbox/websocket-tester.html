<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Tester - Online WS/WSS Connection Debug Tool | Web Toolbox</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Free online WebSocket testing tool, supports ws:// and wss:// protocols. Connect to internal and external WebSocket servers. Real-time messaging, connection monitoring, JSON formatting.">
    <meta name="keywords" content="WebSocket tester,WebSocket debugger,WS testing tool,WSS connection,online WebSocket,Socket test,real-time communication test,free tool">
    <meta name="author" content="heyuan110">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.heyuan110.com/web-toolbox/websocket-tester.html">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.heyuan110.com/web-toolbox/websocket-tester.html">
    <meta property="og:title" content="WebSocket Tester - Online WS/WSS Connection Debug Tool">
    <meta property="og:description" content="Free online WebSocket testing tool, supports ws/wss protocols, real-time messaging and connection monitoring.">
    <meta property="og:image" content="https://www.heyuan110.com/web-toolbox/screenshots/websocket-tester.png">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Web Toolbox">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="WebSocket Tester - Online WS/WSS Connection Debug Tool">
    <meta name="twitter:description" content="Free online WebSocket testing tool, supports ws/wss protocols, real-time messaging.">
    <meta name="twitter:image" content="https://www.heyuan110.com/web-toolbox/screenshots/websocket-tester.png">

    <!-- JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "WebSocket Tester",
        "url": "https://www.heyuan110.com/web-toolbox/websocket-tester.html",
        "description": "Online WebSocket connection testing and debugging tool",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Web Browser",
        "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD"},
        "author": {"@type": "Person", "name": "heyuan110"}
    }
    </script>

    <!-- FAQ JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is WebSocket?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "WebSocket is a full-duplex communication protocol that enables the server to push data to the client proactively. Unlike traditional HTTP request-response mode, WebSocket can communicate bidirectionally in real-time after establishing a connection, suitable for chat, real-time data push, online games, etc."
                }
            },
            {
                "@type": "Question",
                "name": "What is the difference between ws and wss?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "ws is the regular WebSocket protocol, wss is the encrypted WebSocket (similar to the relationship between http and https). wss uses TLS/SSL to encrypt data transmission, which is more secure. It is recommended to use wss protocol in production environments."
                }
            },
            {
                "@type": "Question",
                "name": "Why does WebSocket connection fail?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Common reasons include: incorrect address, server not started, firewall blocking, CORS restrictions, SSL certificate issues (wss protocol), port occupied, etc. It is recommended to check the server status and network connection."
                }
            },
            {
                "@type": "Question",
                "name": "Can I test WebSocket that requires authentication?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "This tool does not support WebSocket connections that require authentication. It only supports non-authenticated WebSocket connection testing. For authenticated connections, it is recommended to use professional WebSocket client tools."
                }
            },
            {
                "@type": "Question",
                "name": "Are there any message format restrictions?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Any text message is supported, JSON format will be automatically formatted for display. The tool automatically detects JSON format and beautifies it for easy API interface debugging."
                }
            }
        ]
    }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e4e4e7;
            line-height: 1.6;
            padding: 30px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* è¿”å›é¦–é¡µ */
        .back-home {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: #a1a1aa;
            text-decoration: none;
            font-size: 0.85rem;
            padding: 8px 12px;
            border-radius: 6px;
            transition: all 0.2s ease;
            margin-bottom: 20px;
        }

        .back-home:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        /* å¤´éƒ¨ */
        header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        header h1 {
            font-size: 2.2rem;
            background: linear-gradient(120deg, #00d4ff, #7c3aed, #f472b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        header p {
            color: #a1a1aa;
            font-size: 0.95rem;
        }

        .tips {
            background: rgba(124, 58, 237, 0.15);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 8px;
            padding: 12px 16px;
            margin-top: 15px;
            font-size: 0.85rem;
            color: #a78bfa;
            display: inline-block;
        }

        .tips code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
        }

        /* è¯­è¨€åˆ‡æ¢å™¨ */
        .lang-switcher { position: absolute; top: 0; right: 0; }
        .lang-dropdown { position: relative; display: inline-block; }
        .lang-current { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 14px; color: #e0e0e0; transition: all 0.3s ease; }
        .lang-current:hover { background: rgba(255,255,255,0.15); }
        .lang-menu { position: absolute; top: 100%; right: 0; margin-top: 4px; background: #1e1e2e; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 4px; min-width: 140px; opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s ease; z-index: 1000; }
        .lang-dropdown.active .lang-menu { opacity: 1; visibility: visible; transform: translateY(0); }
        .lang-btn { display: block; width: 100%; padding: 10px 16px; background: none; border: none; color: #e0e0e0; font-size: 14px; text-align: left; cursor: pointer; border-radius: 6px; transition: background 0.2s ease; }
        .lang-btn:hover { background: rgba(255,255,255,0.1); }

        /* ä¸»å¸ƒå±€ */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 900px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
        }

        .card-header {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card-header h2 {
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-body {
            padding: 20px;
        }

        /* è¿æ¥åŒºåŸŸ */
        .connection-section {
            grid-column: 1 / -1;
        }

        .connection-form {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .url-input-wrapper {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .url-input-wrapper .protocol {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #22c55e;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            pointer-events: none;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            padding-left: 55px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            color: #e4e4e7;
            font-size: 0.95rem;
            font-family: 'Monaco', 'Menlo', monospace;
            transition: all 0.2s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #7c3aed;
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2);
        }

        /* æŒ‰é’® */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .btn-connect {
            background: linear-gradient(135deg, #059669, #10b981);
            color: #fff;
        }

        .btn-connect:hover {
            background: linear-gradient(135deg, #10b981, #34d399);
            transform: translateY(-2px);
        }

        .btn-disconnect {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            color: #fff;
        }

        .btn-disconnect:hover {
            background: linear-gradient(135deg, #ef4444, #f87171);
            transform: translateY(-2px);
        }

        .btn-send {
            background: linear-gradient(135deg, #7c3aed, #6366f1);
            color: #fff;
        }

        .btn-send:hover {
            background: linear-gradient(135deg, #8b5cf6, #818cf8);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e4e4e7;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #71717a;
            animation: none;
        }

        .status-dot.connecting {
            background: #f59e0b;
            animation: pulse 1s infinite;
        }

        .status-dot.connected {
            background: #22c55e;
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
        }

        .status-dot.disconnected {
            background: #ef4444;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-text {
            color: #a1a1aa;
        }

        .status-text.connected {
            color: #22c55e;
        }

        .status-text.connecting {
            color: #f59e0b;
        }

        .status-text.disconnected {
            color: #ef4444;
        }

        /* æ¶ˆæ¯è¾“å…¥ */
        .message-input-area {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            color: #e4e4e7;
            font-size: 0.9rem;
            font-family: 'Monaco', 'Menlo', monospace;
            resize: vertical;
            transition: all 0.2s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #7c3aed;
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2);
        }

        .message-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        .message-type {
            display: flex;
            gap: 5px;
        }

        .message-type label {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .message-type input[type="radio"] {
            display: none;
        }

        .message-type input[type="radio"]:checked + label {
            background: rgba(124, 58, 237, 0.3);
            border-color: #7c3aed;
            color: #a78bfa;
        }

        .send-actions {
            display: flex;
            gap: 10px;
            margin-left: auto;
        }

        /* æ¶ˆæ¯æ—¥å¿— */
        .message-log {
            height: 400px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 10px;
        }

        .message-log::-webkit-scrollbar {
            width: 8px;
        }

        .message-log::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .message-log::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        .message-log::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .log-entry {
            padding: 8px 12px;
            margin-bottom: 8px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-family: 'Monaco', 'Menlo', monospace;
            animation: slideIn 0.2s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .log-entry.sent {
            background: rgba(124, 58, 237, 0.2);
            border-left: 3px solid #7c3aed;
        }

        .log-entry.received {
            background: rgba(34, 197, 94, 0.2);
            border-left: 3px solid #22c55e;
        }

        .log-entry.system {
            background: rgba(59, 130, 246, 0.2);
            border-left: 3px solid #3b82f6;
        }

        .log-entry.error {
            background: rgba(239, 68, 68, 0.2);
            border-left: 3px solid #ef4444;
        }

        .log-entry .time {
            color: #71717a;
            font-size: 0.75rem;
            margin-right: 10px;
        }

        .log-entry .direction {
            font-weight: 600;
            margin-right: 8px;
        }

        .log-entry.sent .direction {
            color: #a78bfa;
        }

        .log-entry.received .direction {
            color: #22c55e;
        }

        .log-entry.system .direction {
            color: #3b82f6;
        }

        .log-entry.error .direction {
            color: #ef4444;
        }

        .log-entry .content {
            word-break: break-all;
            white-space: pre-wrap;
        }

        .log-empty {
            text-align: center;
            color: #71717a;
            padding: 40px;
        }

        .log-empty .icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        /* å¿«æ·æ¶ˆæ¯ */
        .quick-messages {
            margin-top: 15px;
        }

        .quick-messages h4 {
            font-size: 0.8rem;
            color: #71717a;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .quick-msg-list {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .quick-msg {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .quick-msg:hover {
            background: rgba(124, 58, 237, 0.2);
            border-color: #7c3aed;
        }

        /* å†å²è®°å½• */
        .history-list {
            max-height: 150px;
            overflow-y: auto;
        }

        .history-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            margin-bottom: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .history-item:hover {
            background: rgba(124, 58, 237, 0.2);
        }

        .history-item .url {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.85rem;
            color: #e4e4e7;
        }

        .history-item .delete-btn {
            background: none;
            border: none;
            color: #71717a;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .history-item .delete-btn:hover {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.2);
        }

        .no-history {
            text-align: center;
            color: #71717a;
            padding: 20px;
            font-size: 0.85rem;
        }

        /* ç»Ÿè®¡ä¿¡æ¯ */
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .stat-item .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #fff;
        }

        .stat-item .label {
            font-size: 0.75rem;
            color: #71717a;
            margin-top: 4px;
        }

        .stat-item.sent .value { color: #a78bfa; }
        .stat-item.received .value { color: #22c55e; }
        .stat-item.errors .value { color: #ef4444; }
        .stat-item.time .value { color: #3b82f6; font-size: 1rem; }

        @media (max-width: 600px) {
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Toast æç¤º */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 12px 24px;
            background: rgba(34, 197, 94, 0.9);
            color: #fff;
            border-radius: 8px;
            font-size: 0.9rem;
            z-index: 1000;
            animation: toastIn 0.3s ease;
        }

        .toast.error {
            background: rgba(239, 68, 68, 0.9);
        }

        @keyframes toastIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* åº•éƒ¨è¯´æ˜ */
        .footer-notes {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
        }

        .footer-notes h3 {
            font-size: 1rem;
            margin-bottom: 15px;
            color: #e4e4e7;
        }

        .footer-notes ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .footer-notes li {
            padding: 10px 14px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            font-size: 0.85rem;
            color: #a1a1aa;
            line-height: 1.6;
            word-break: break-word;
        }

        .footer-notes li::before {
            content: "â€¢ ";
            color: #7c3aed;
            font-weight: bold;
        }

        .footer-notes code {
            background: rgba(124, 58, 237, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.8rem;
            color: #a78bfa;
            word-break: break-all;
        }

        /* åŠŸèƒ½ç‰¹ç‚¹åŒºå— */
        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 16px;
            margin-bottom: 30px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(124, 58, 237, 0.3);
            transform: translateY(-2px);
        }

        .feature-card .icon {
            font-size: 2rem;
            margin-bottom: 12px;
        }

        .feature-card h3 {
            font-size: 1rem;
            color: #e4e4e7;
            margin-bottom: 8px;
        }

        .feature-card p {
            font-size: 0.85rem;
            color: #a1a1aa;
            line-height: 1.6;
        }

        /* FAQ åŒºå— */
        .faq-section {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 24px;
        }

        .faq-section h2 {
            font-size: 1.2rem;
            color: #e4e4e7;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .faq-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            padding: 16px 0;
        }

        .faq-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .faq-item:first-of-type {
            padding-top: 0;
        }

        .faq-question {
            font-size: 0.95rem;
            font-weight: 600;
            color: #e4e4e7;
            margin-bottom: 10px;
            cursor: pointer;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .faq-question::before {
            content: "Q";
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #7c3aed, #6366f1);
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
            color: #fff;
        }

        .faq-answer {
            font-size: 0.9rem;
            color: #a1a1aa;
            line-height: 1.7;
            padding-left: 34px;
        }

        .faq-answer code {
            background: rgba(124, 58, 237, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.8rem;
            color: #a78bfa;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-home" data-i18n="backHome">â† Back to Toolbox Home</a>

        <header>
            <div class="lang-switcher">
                <div class="lang-dropdown" id="langDropdown">
                    <div class="lang-current" id="langCurrent">ğŸŒ English</div>
                    <div class="lang-menu">
                        <button class="lang-btn" data-lang="en">ğŸ‡ºğŸ‡¸ English</button>
                        <button class="lang-btn" data-lang="zh-CN">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</button>
                        <button class="lang-btn" data-lang="fr">ğŸ‡«ğŸ‡· FranÃ§ais</button>
                        <button class="lang-btn" data-lang="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</button>
                    </div>
                </div>
            </div>
            <h1 data-i18n="pageTitle">ğŸ”Œ WebSocket Online Tester</h1>
            <p data-i18n="pageSubtitle">HTML5 WebSocket-based online debugging tool, supports internal and external connection testing</p>
            <div class="tips">
                <span data-i18n="connectionFormat">Connection format:</span> <code>ws://IP-or-domain:port</code> <span data-i18n="or">or</span> <code>wss://IP-or-domain:port</code>
                &nbsp;<span data-i18n="example">Example:</span> <code>ws://127.0.0.1:8080</code>
            </div>
        </header>

        <!-- åŠŸèƒ½ç‰¹ç‚¹ -->
        <section class="features-section">
            <div class="feature-card">
                <div class="icon">ğŸ”—</div>
                <h3 data-i18n="featureConnectionTitle">Connection Testing</h3>
                <p data-i18n="featureConnectionDesc">Quickly test WebSocket server connection status, supports both ws:// and wss:// protocols</p>
            </div>
            <div class="feature-card">
                <div class="icon">ğŸ’¬</div>
                <h3 data-i18n="featureMessagingTitle">Messaging</h3>
                <p data-i18n="featureMessagingDesc">Supports sending text and JSON format messages, real-time display of server responses</p>
            </div>
            <div class="feature-card">
                <div class="icon">ğŸ“œ</div>
                <h3 data-i18n="featureHistoryTitle">Connection History</h3>
                <p data-i18n="featureHistoryDesc">Automatically saves connection records for convenient repeated testing of the same WebSocket address</p>
            </div>
            <div class="feature-card">
                <div class="icon">{ }</div>
                <h3 data-i18n="featureFormatTitle">Message Formatting</h3>
                <p data-i18n="featureFormatDesc">Automatically detects and formats JSON messages for clearer and more readable debugging data</p>
            </div>
        </section>

        <!-- è¿æ¥åŒºåŸŸ -->
        <div class="main-layout">
            <div class="card connection-section">
                <div class="card-header">
                    <h2 data-i18n="connectionSettings">ğŸ”— Connection Settings</h2>
                    <div class="status-indicator">
                        <div class="status-dot" id="statusDot"></div>
                        <span class="status-text" id="statusText" data-i18n="statusDisconnected">Disconnected</span>
                    </div>
                </div>
                <div class="card-body">
                    <div class="connection-form">
                        <div class="url-input-wrapper">
                            <span class="protocol" id="protocolLabel">ws://</span>
                            <input type="text" id="wsUrl" data-i18n-placeholder="urlPlaceholder" placeholder="127.0.0.1:8080/ws" value="echo.websocket.org">
                        </div>
                        <button class="btn btn-connect" id="connectBtn" onclick="connect()">
                            <span>ğŸ”Œ</span> <span data-i18n="connect">Connect</span>
                        </button>
                        <button class="btn btn-disconnect" id="disconnectBtn" onclick="disconnect()" disabled>
                            <span>â¹ï¸</span> <span data-i18n="disconnect">Disconnect</span>
                        </button>
                    </div>
                    <div class="message-options" style="margin-top: 15px;">
                        <div class="message-type">
                            <input type="radio" name="protocol" id="ws" value="ws://" checked onchange="updateProtocol()">
                            <label for="ws">WS</label>
                            <input type="radio" name="protocol" id="wss" value="wss://" onchange="updateProtocol()">
                            <label for="wss">WSS (SSL)</label>
                        </div>
                    </div>

                    <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                    <div class="stats">
                        <div class="stat-item sent">
                            <div class="value" id="sentCount">0</div>
                            <div class="label" data-i18n="statSent">Sent</div>
                        </div>
                        <div class="stat-item received">
                            <div class="value" id="receivedCount">0</div>
                            <div class="label" data-i18n="statReceived">Received</div>
                        </div>
                        <div class="stat-item errors">
                            <div class="value" id="errorCount">0</div>
                            <div class="label" data-i18n="statErrors">Errors</div>
                        </div>
                        <div class="stat-item time">
                            <div class="value" id="connectedTime">--:--</div>
                            <div class="label" data-i18n="statDuration">Duration</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å‘é€æ¶ˆæ¯ -->
            <div class="card">
                <div class="card-header">
                    <h2 data-i18n="sendMessage">ğŸ“¤ Send Message</h2>
                </div>
                <div class="card-body">
                    <div class="message-input-area">
                        <textarea id="messageInput" data-i18n-placeholder="messagePlaceholder" placeholder="Enter message content to send..."></textarea>
                        <div class="message-options">
                            <div class="message-type">
                                <input type="radio" name="msgType" id="textMsg" value="text" checked>
                                <label for="textMsg" data-i18n="msgTypeText">Text</label>
                                <input type="radio" name="msgType" id="jsonMsg" value="json">
                                <label for="jsonMsg">JSON</label>
                            </div>
                            <div class="send-actions">
                                <button class="btn btn-secondary" onclick="formatJson()" data-i18n="formatJson">Format JSON</button>
                                <button class="btn btn-secondary" onclick="clearMessage()" data-i18n="clear">Clear</button>
                                <button class="btn btn-send" id="sendBtn" onclick="sendMessage()" disabled>
                                    <span>ğŸ“¤</span> <span data-i18n="send">Send</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="quick-messages">
                        <h4 data-i18n="quickMessages">Quick Messages</h4>
                        <div class="quick-msg-list">
                            <span class="quick-msg" onclick="setQuickMessage('ping')">ping</span>
                            <span class="quick-msg" onclick="setQuickMessage('pong')">pong</span>
                            <span class="quick-msg" onclick="setQuickMessage('hello')">hello</span>
                            <span class="quick-msg" onclick="setQuickMessage('{&quot;type&quot;:&quot;ping&quot;}')">{ping}</span>
                            <span class="quick-msg" onclick="setQuickMessage('{&quot;action&quot;:&quot;subscribe&quot;,&quot;channel&quot;:&quot;test&quot;}')">{subscribe}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ¶ˆæ¯æ—¥å¿— -->
            <div class="card">
                <div class="card-header">
                    <h2 data-i18n="messageLog">ğŸ“‹ Message Log</h2>
                    <button class="btn btn-secondary" onclick="clearLog()" style="padding: 6px 12px; font-size: 0.8rem;">
                        ğŸ—‘ï¸ <span data-i18n="clearLog">Clear</span>
                    </button>
                </div>
                <div class="card-body">
                    <div class="message-log" id="messageLog">
                        <div class="log-empty">
                            <div class="icon">ğŸ“­</div>
                            <p data-i18n="noMessages">No messages yet</p>
                            <p style="font-size: 0.8rem; margin-top: 5px;" data-i18n="noMessagesHint">Messages will appear here after connecting to WebSocket</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä½¿ç”¨è¯´æ˜ -->
        <div class="footer-notes">
            <h3 data-i18n="usageGuide">ğŸ“– Usage Guide</h3>
            <ul>
                <li data-i18n="usageNote1">Supports <code>ws://</code> (regular) and <code>wss://</code> (SSL encrypted) protocols</li>
                <li data-i18n="usageNote2">Internal test: <code>ws://192.168.1.100:8080</code> or <code>ws://localhost:3000</code></li>
                <li data-i18n="usageNote3">External test: <code>wss://example.com/ws</code> or <code>ws://your-domain.com:8080</code></li>
                <li data-i18n="usageNote4">Supports sending plain text and JSON format messages, with automatic JSON formatting</li>
                <li data-i18n="usageNote5">Real-time display of sent/received messages with timestamps and content</li>
                <li data-i18n="usageNote6">Real-time connection status monitoring, statistics for sent/received/error counts</li>
            </ul>
        </div>
    </div>

    <script>
        // ==================== å›½é™…åŒ–æ¨¡å— ====================
        const i18n = {
            currentLang: 'en',
            translations: {
                en: {
                    backHome: 'â† Back to Toolbox Home',
                    pageTitle: 'ğŸ”Œ WebSocket Online Tester',
                    pageSubtitle: 'HTML5 WebSocket-based online debugging tool, supports internal and external connection testing',
                    connectionFormat: 'Connection format:',
                    or: 'or',
                    example: 'Example:',
                    featureConnectionTitle: 'Connection Testing',
                    featureConnectionDesc: 'Quickly test WebSocket server connection status, supports both ws:// and wss:// protocols',
                    featureMessagingTitle: 'Messaging',
                    featureMessagingDesc: 'Supports sending text and JSON format messages, real-time display of server responses',
                    featureHistoryTitle: 'Connection History',
                    featureHistoryDesc: 'Automatically saves connection records for convenient repeated testing of the same WebSocket address',
                    featureFormatTitle: 'Message Formatting',
                    featureFormatDesc: 'Automatically detects and formats JSON messages for clearer and more readable debugging data',
                    connectionSettings: 'ğŸ”— Connection Settings',
                    statusDisconnected: 'Disconnected',
                    statusConnecting: 'Connecting...',
                    statusConnected: 'Connected',
                    urlPlaceholder: '127.0.0.1:8080/ws',
                    connect: 'Connect',
                    disconnect: 'Disconnect',
                    statSent: 'Sent',
                    statReceived: 'Received',
                    statErrors: 'Errors',
                    statDuration: 'Duration',
                    sendMessage: 'ğŸ“¤ Send Message',
                    messagePlaceholder: 'Enter message content to send...',
                    msgTypeText: 'Text',
                    formatJson: 'Format JSON',
                    clear: 'Clear',
                    send: 'Send',
                    quickMessages: 'Quick Messages',
                    messageLog: 'ğŸ“‹ Message Log',
                    clearLog: 'Clear',
                    noMessages: 'No messages yet',
                    noMessagesHint: 'Messages will appear here after connecting to WebSocket',
                    usageGuide: 'ğŸ“– Usage Guide',
                    usageNote1: 'Supports <code>ws://</code> (regular) and <code>wss://</code> (SSL encrypted) protocols',
                    usageNote2: 'Internal test: <code>ws://192.168.1.100:8080</code> or <code>ws://localhost:3000</code>',
                    usageNote3: 'External test: <code>wss://example.com/ws</code> or <code>ws://your-domain.com:8080</code>',
                    usageNote4: 'Supports sending plain text and JSON format messages, with automatic JSON formatting',
                    usageNote5: 'Real-time display of sent/received messages with timestamps and content',
                    usageNote6: 'Real-time connection status monitoring, statistics for sent/received/error counts',
                    faqTitle: 'â“ FAQ',
                    faq1Question: 'What is WebSocket?',
                    faq1Answer: 'WebSocket is a full-duplex communication protocol that enables the server to push data to the client proactively. Unlike traditional HTTP request-response mode, WebSocket can communicate bidirectionally in real-time after establishing a connection, suitable for chat, real-time data push, online games, etc.',
                    faq2Question: 'What is the difference between ws and wss?',
                    faq2Answer: 'ws is the regular WebSocket protocol, wss is the encrypted WebSocket (similar to the relationship between <code>http</code> and <code>https</code>). wss uses TLS/SSL to encrypt data transmission, which is more secure. It is recommended to use wss protocol in production environments.',
                    faq3Question: 'Why does WebSocket connection fail?',
                    faq3Answer: 'Common reasons include: incorrect address, server not started, firewall blocking, CORS restrictions, SSL certificate issues (wss protocol), port occupied, etc. It is recommended to check the server status and network connection to ensure the WebSocket service is running normally.',
                    faq4Question: 'Can I test WebSocket that requires authentication?',
                    faq4Answer: 'This tool does not support WebSocket connections that require authentication. It only supports non-authenticated WebSocket connection testing. For authenticated connections, it is recommended to use professional WebSocket client tools like Postman or wscat.',
                    faq5Question: 'Are there any message format restrictions?',
                    faq5Answer: 'Any text message is supported, JSON format will be automatically formatted for display. The tool automatically detects JSON format and beautifies it for easy API interface debugging. There is no specific message length limit, but it is recommended to keep single messages under 64KB.',
                    relatedTools: 'ğŸ”— Related Tools',
                    jsonViewer: 'JSON Viewer',
                    jsonViewerDesc: 'JSON formatting and visualization',
                    cryptoTools: 'Crypto Toolbox',
                    cryptoToolsDesc: 'Base64/MD5/AES etc.',
                    ipLookup: 'IP Lookup',
                    ipLookupDesc: 'Query IP geolocation',
                    regexTester: 'Regex Tester',
                    regexTesterDesc: 'Online regex matching and debugging',
                    footerNote: 'Pure frontend processing, data will not be uploaded to server',
                    footerBackHome: 'â† Back to Web Toolbox Home',
                    // æ—¥å¿—æ¶ˆæ¯
                    logConnecting: 'Connecting to',
                    logConnected: 'Connected successfully!',
                    logDisconnecting: 'Disconnecting...',
                    logConnectionClosed: 'Connection closed',
                    logConnectionError: 'Connection error',
                    logSendFailed: 'Send failed:',
                    logConnectFailed: 'Connection failed:',
                    logUserDisconnect: 'User disconnected',
                    logDirectionSent: 'Sent â†’',
                    logDirectionReceived: 'â† Received',
                    logDirectionSystem: 'System',
                    logDirectionError: 'Error',
                    // Toast æ¶ˆæ¯
                    toastEnterValidUrl: 'Please enter a valid WebSocket address',
                    toastNotConnected: 'WebSocket not connected',
                    toastEnterMessage: 'Please enter message content',
                    toastInvalidJson: 'Invalid JSON format',
                    langName: 'ğŸŒ English'
                },
                'zh-CN': {
                    backHome: 'â† è¿”å›å·¥å…·ç®±é¦–é¡µ',
                    pageTitle: 'ğŸ”Œ WebSocket åœ¨çº¿æµ‹è¯•å·¥å…·',
                    pageSubtitle: 'åŸºäº HTML5 WebSocket çš„åœ¨çº¿è°ƒè¯•å·¥å…·ï¼Œæ”¯æŒå†…ç½‘å’Œå¤–ç½‘è¿æ¥æµ‹è¯•',
                    connectionFormat: 'è¿æ¥æ ¼å¼ï¼š',
                    or: 'æˆ–',
                    example: 'ç¤ºä¾‹ï¼š',
                    featureConnectionTitle: 'è¿æ¥æµ‹è¯•',
                    featureConnectionDesc: 'å¿«é€Ÿæµ‹è¯• WebSocket æœåŠ¡å™¨è¿æ¥çŠ¶æ€ï¼Œæ”¯æŒ ws:// å’Œ wss:// ä¸¤ç§åè®®',
                    featureMessagingTitle: 'æ¶ˆæ¯æ”¶å‘',
                    featureMessagingDesc: 'æ”¯æŒå‘é€æ–‡æœ¬å’Œ JSON æ ¼å¼æ¶ˆæ¯ï¼Œå®æ—¶æ˜¾ç¤ºæœåŠ¡å™¨å“åº”å†…å®¹',
                    featureHistoryTitle: 'è¿æ¥å†å²',
                    featureHistoryDesc: 'è‡ªåŠ¨ä¿å­˜è¿æ¥è®°å½•ï¼Œæ–¹ä¾¿é‡å¤æµ‹è¯•ç›¸åŒçš„ WebSocket åœ°å€',
                    featureFormatTitle: 'æ¶ˆæ¯æ ¼å¼åŒ–',
                    featureFormatDesc: 'è‡ªåŠ¨æ£€æµ‹å¹¶æ ¼å¼åŒ– JSON æ¶ˆæ¯ï¼Œè®©è°ƒè¯•æ•°æ®æ›´åŠ æ¸…æ™°æ˜“è¯»',
                    connectionSettings: 'ğŸ”— è¿æ¥è®¾ç½®',
                    statusDisconnected: 'æœªè¿æ¥',
                    statusConnecting: 'è¿æ¥ä¸­...',
                    statusConnected: 'å·²è¿æ¥',
                    urlPlaceholder: '127.0.0.1:8080/ws',
                    connect: 'è¿æ¥',
                    disconnect: 'æ–­å¼€',
                    statSent: 'å·²å‘é€',
                    statReceived: 'å·²æ¥æ”¶',
                    statErrors: 'é”™è¯¯',
                    statDuration: 'è¿æ¥æ—¶é•¿',
                    sendMessage: 'ğŸ“¤ å‘é€æ¶ˆæ¯',
                    messagePlaceholder: 'è¾“å…¥è¦å‘é€çš„æ¶ˆæ¯å†…å®¹...',
                    msgTypeText: 'æ–‡æœ¬',
                    formatJson: 'æ ¼å¼åŒ– JSON',
                    clear: 'æ¸…ç©º',
                    send: 'å‘é€',
                    quickMessages: 'å¿«æ·æ¶ˆæ¯',
                    messageLog: 'ğŸ“‹ æ¶ˆæ¯æ—¥å¿—',
                    clearLog: 'æ¸…ç©º',
                    noMessages: 'æš‚æ— æ¶ˆæ¯è®°å½•',
                    noMessagesHint: 'è¿æ¥ WebSocket åï¼Œæ¶ˆæ¯å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ',
                    usageGuide: 'ğŸ“– ä½¿ç”¨è¯´æ˜',
                    usageNote1: 'æ”¯æŒ <code>ws://</code>ï¼ˆæ™®é€šï¼‰å’Œ <code>wss://</code>ï¼ˆSSLåŠ å¯†ï¼‰ä¸¤ç§åè®®',
                    usageNote2: 'å†…ç½‘æµ‹è¯•ï¼š<code>ws://192.168.1.100:8080</code> æˆ– <code>ws://localhost:3000</code>',
                    usageNote3: 'å¤–ç½‘æµ‹è¯•ï¼š<code>wss://example.com/ws</code> æˆ– <code>ws://your-domain.com:8080</code>',
                    usageNote4: 'æ”¯æŒå‘é€çº¯æ–‡æœ¬å’Œ JSON æ ¼å¼æ¶ˆæ¯ï¼Œå¯è‡ªåŠ¨æ ¼å¼åŒ– JSON',
                    usageNote5: 'å®æ—¶æ˜¾ç¤ºå‘é€/æ¥æ”¶æ¶ˆæ¯ï¼ŒåŒ…å«æ—¶é—´æˆ³å’Œæ¶ˆæ¯å†…å®¹',
                    usageNote6: 'è¿æ¥çŠ¶æ€å®æ—¶ç›‘æ§ï¼Œç»Ÿè®¡å‘é€/æ¥æ”¶/é”™è¯¯æ¬¡æ•°',
                    faqTitle: 'â“ å¸¸è§é—®é¢˜',
                    faq1Question: 'ä»€ä¹ˆæ˜¯ WebSocketï¼Ÿ',
                    faq1Answer: 'WebSocket æ˜¯ä¸€ç§å…¨åŒå·¥é€šä¿¡åè®®ï¼Œæ”¯æŒæœåŠ¡å™¨ä¸»åŠ¨æ¨é€æ•°æ®åˆ°å®¢æˆ·ç«¯ã€‚ä¸ä¼ ç»Ÿ HTTP è¯·æ±‚-å“åº”æ¨¡å¼ä¸åŒï¼ŒWebSocket å»ºç«‹è¿æ¥åå¯ä»¥åŒå‘å®æ—¶é€šä¿¡ï¼Œé€‚ç”¨äºèŠå¤©ã€å®æ—¶æ•°æ®æ¨é€ã€åœ¨çº¿æ¸¸æˆç­‰åœºæ™¯ã€‚',
                    faq2Question: 'ws å’Œ wss æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ',
                    faq2Answer: 'ws æ˜¯æ™®é€š WebSocket åè®®ï¼Œwss æ˜¯åŠ å¯†çš„ WebSocketï¼ˆç±»ä¼¼ <code>http</code> å’Œ <code>https</code> çš„å…³ç³»ï¼‰ã€‚wss ä½¿ç”¨ TLS/SSL åŠ å¯†ä¼ è¾“æ•°æ®ï¼Œæ›´åŠ å®‰å…¨ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ wss åè®®ã€‚',
                    faq3Question: 'ä¸ºä»€ä¹ˆ WebSocket è¿æ¥å¤±è´¥ï¼Ÿ',
                    faq3Answer: 'å¸¸è§åŸå› åŒ…æ‹¬ï¼šåœ°å€é”™è¯¯ã€æœåŠ¡å™¨æœªå¯åŠ¨ã€é˜²ç«å¢™é˜»æ­¢ã€CORS é™åˆ¶ã€SSL è¯ä¹¦é—®é¢˜ï¼ˆwss åè®®ï¼‰ã€ç«¯å£è¢«å ç”¨ç­‰ã€‚å»ºè®®æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€å’Œç½‘ç»œè¿æ¥ï¼Œç¡®ä¿ WebSocket æœåŠ¡æ­£å¸¸è¿è¡Œã€‚',
                    faq4Question: 'å¯ä»¥æµ‹è¯•éœ€è¦è®¤è¯çš„ WebSocket å—ï¼Ÿ',
                    faq4Answer: 'æœ¬å·¥å…·æš‚ä¸æ”¯æŒéœ€è¦è®¤è¯çš„ WebSocket è¿æ¥ï¼Œä»…æ”¯æŒæ— è®¤è¯çš„ WebSocket è¿æ¥æµ‹è¯•ã€‚å¦‚éœ€æµ‹è¯•å¸¦è®¤è¯çš„è¿æ¥ï¼Œå»ºè®®ä½¿ç”¨ä¸“ä¸šçš„ WebSocket å®¢æˆ·ç«¯å·¥å…·å¦‚ Postman æˆ– wscatã€‚',
                    faq5Question: 'æ¶ˆæ¯æ ¼å¼æœ‰é™åˆ¶å—ï¼Ÿ',
                    faq5Answer: 'æ”¯æŒå‘é€ä»»æ„æ–‡æœ¬æ¶ˆæ¯ï¼ŒJSON æ ¼å¼ä¼šè‡ªåŠ¨æ ¼å¼åŒ–æ˜¾ç¤ºã€‚å·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹ JSON æ ¼å¼å¹¶è¿›è¡Œç¾åŒ–å±•ç¤ºï¼Œæ–¹ä¾¿è°ƒè¯• API æ¥å£ã€‚æ¶ˆæ¯é•¿åº¦æ²¡æœ‰ç‰¹åˆ«é™åˆ¶ï¼Œä½†å»ºè®®å•æ¡æ¶ˆæ¯ä¸è¶…è¿‡ 64KBã€‚',
                    relatedTools: 'ğŸ”— ç›¸å…³å·¥å…·æ¨è',
                    jsonViewer: 'JSON æŸ¥çœ‹å™¨',
                    jsonViewerDesc: 'JSON æ ¼å¼åŒ–ä¸å¯è§†åŒ–',
                    cryptoTools: 'åŠ è§£å¯†å·¥å…·ç®±',
                    cryptoToolsDesc: 'Base64/MD5/AES ç­‰',
                    ipLookup: 'IP å½’å±åœ°æŸ¥è¯¢',
                    ipLookupDesc: 'æŸ¥è¯¢ IP åœ°ç†ä½ç½®',
                    regexTester: 'æ­£åˆ™è¡¨è¾¾å¼æµ‹è¯•',
                    regexTesterDesc: 'åœ¨çº¿æ­£åˆ™åŒ¹é…ä¸è°ƒè¯•',
                    footerNote: 'çº¯å‰ç«¯å¤„ç†ï¼Œæ•°æ®ä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨',
                    footerBackHome: 'â† è¿”å› Web Toolbox é¦–é¡µ',
                    // æ—¥å¿—æ¶ˆæ¯
                    logConnecting: 'æ­£åœ¨è¿æ¥',
                    logConnected: 'è¿æ¥æˆåŠŸï¼',
                    logDisconnecting: 'æ­£åœ¨æ–­å¼€è¿æ¥...',
                    logConnectionClosed: 'è¿æ¥å·²å…³é—­',
                    logConnectionError: 'è¿æ¥å‘ç”Ÿé”™è¯¯',
                    logSendFailed: 'å‘é€å¤±è´¥ï¼š',
                    logConnectFailed: 'è¿æ¥å¤±è´¥ï¼š',
                    logUserDisconnect: 'ç”¨æˆ·ä¸»åŠ¨æ–­å¼€',
                    logDirectionSent: 'å‘é€ â†’',
                    logDirectionReceived: 'â† æ¥æ”¶',
                    logDirectionSystem: 'ç³»ç»Ÿ',
                    logDirectionError: 'é”™è¯¯',
                    // Toast æ¶ˆæ¯
                    toastEnterValidUrl: 'è¯·è¾“å…¥æœ‰æ•ˆçš„ WebSocket åœ°å€',
                    toastNotConnected: 'WebSocket æœªè¿æ¥',
                    toastEnterMessage: 'è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹',
                    toastInvalidJson: 'æ— æ•ˆçš„ JSON æ ¼å¼',
                    langName: 'ğŸŒ ä¸­æ–‡'
                },
                fr: {
                    backHome: 'â† Retour Ã  la boÃ®te Ã  outils',
                    pageTitle: 'ğŸ”Œ Testeur WebSocket en ligne',
                    pageSubtitle: 'Outil de dÃ©bogage en ligne basÃ© sur HTML5 WebSocket, prend en charge les tests de connexion internes et externes',
                    connectionFormat: 'Format de connexion :',
                    or: 'ou',
                    example: 'Exemple :',
                    featureConnectionTitle: 'Test de connexion',
                    featureConnectionDesc: 'Testez rapidement l\'Ã©tat de connexion du serveur WebSocket, prend en charge les protocoles ws:// et wss://',
                    featureMessagingTitle: 'Messagerie',
                    featureMessagingDesc: 'Prend en charge l\'envoi de messages texte et JSON, affichage en temps rÃ©el des rÃ©ponses du serveur',
                    featureHistoryTitle: 'Historique de connexion',
                    featureHistoryDesc: 'Enregistre automatiquement les connexions pour faciliter les tests rÃ©pÃ©tÃ©s de la mÃªme adresse WebSocket',
                    featureFormatTitle: 'Formatage des messages',
                    featureFormatDesc: 'DÃ©tecte et formate automatiquement les messages JSON pour des donnÃ©es de dÃ©bogage plus claires et lisibles',
                    connectionSettings: 'ğŸ”— ParamÃ¨tres de connexion',
                    statusDisconnected: 'DÃ©connectÃ©',
                    statusConnecting: 'Connexion...',
                    statusConnected: 'ConnectÃ©',
                    urlPlaceholder: '127.0.0.1:8080/ws',
                    connect: 'Connecter',
                    disconnect: 'DÃ©connecter',
                    statSent: 'EnvoyÃ©s',
                    statReceived: 'ReÃ§us',
                    statErrors: 'Erreurs',
                    statDuration: 'DurÃ©e',
                    sendMessage: 'ğŸ“¤ Envoyer un message',
                    messagePlaceholder: 'Entrez le contenu du message Ã  envoyer...',
                    msgTypeText: 'Texte',
                    formatJson: 'Formater JSON',
                    clear: 'Effacer',
                    send: 'Envoyer',
                    quickMessages: 'Messages rapides',
                    messageLog: 'ğŸ“‹ Journal des messages',
                    clearLog: 'Effacer',
                    noMessages: 'Aucun message pour le moment',
                    noMessagesHint: 'Les messages apparaÃ®tront ici aprÃ¨s la connexion au WebSocket',
                    usageGuide: 'ğŸ“– Guide d\'utilisation',
                    usageNote1: 'Prend en charge les protocoles <code>ws://</code> (standard) et <code>wss://</code> (chiffrÃ© SSL)',
                    usageNote2: 'Test interne : <code>ws://192.168.1.100:8080</code> ou <code>ws://localhost:3000</code>',
                    usageNote3: 'Test externe : <code>wss://example.com/ws</code> ou <code>ws://your-domain.com:8080</code>',
                    usageNote4: 'Prend en charge l\'envoi de messages texte brut et JSON, avec formatage JSON automatique',
                    usageNote5: 'Affichage en temps rÃ©el des messages envoyÃ©s/reÃ§us avec horodatage et contenu',
                    usageNote6: 'Surveillance en temps rÃ©el de l\'Ã©tat de connexion, statistiques d\'envoi/rÃ©ception/erreurs',
                    faqTitle: 'â“ FAQ',
                    faq1Question: 'Qu\'est-ce que WebSocket ?',
                    faq1Answer: 'WebSocket est un protocole de communication full-duplex qui permet au serveur d\'envoyer des donnÃ©es au client de maniÃ¨re proactive. Contrairement au mode requÃªte-rÃ©ponse HTTP traditionnel, WebSocket peut communiquer de maniÃ¨re bidirectionnelle en temps rÃ©el aprÃ¨s l\'Ã©tablissement d\'une connexion, adaptÃ© au chat, Ã  la diffusion de donnÃ©es en temps rÃ©el, aux jeux en ligne, etc.',
                    faq2Question: 'Quelle est la diffÃ©rence entre ws et wss ?',
                    faq2Answer: 'ws est le protocole WebSocket standard, wss est le WebSocket chiffrÃ© (similaire Ã  la relation entre <code>http</code> et <code>https</code>). wss utilise TLS/SSL pour chiffrer la transmission de donnÃ©es, ce qui est plus sÃ©curisÃ©. Il est recommandÃ© d\'utiliser le protocole wss dans les environnements de production.',
                    faq3Question: 'Pourquoi la connexion WebSocket Ã©choue-t-elle ?',
                    faq3Answer: 'Les raisons courantes incluent : adresse incorrecte, serveur non dÃ©marrÃ©, blocage par pare-feu, restrictions CORS, problÃ¨mes de certificat SSL (protocole wss), port occupÃ©, etc. Il est recommandÃ© de vÃ©rifier l\'Ã©tat du serveur et la connexion rÃ©seau pour s\'assurer que le service WebSocket fonctionne normalement.',
                    faq4Question: 'Puis-je tester un WebSocket nÃ©cessitant une authentification ?',
                    faq4Answer: 'Cet outil ne prend pas en charge les connexions WebSocket nÃ©cessitant une authentification. Il ne prend en charge que les tests de connexion WebSocket sans authentification. Pour les connexions authentifiÃ©es, il est recommandÃ© d\'utiliser des outils clients WebSocket professionnels comme Postman ou wscat.',
                    faq5Question: 'Y a-t-il des restrictions sur le format des messages ?',
                    faq5Answer: 'Tout message texte est pris en charge, le format JSON sera automatiquement formatÃ© pour l\'affichage. L\'outil dÃ©tecte automatiquement le format JSON et l\'embellit pour faciliter le dÃ©bogage de l\'interface API. Il n\'y a pas de limite de longueur de message spÃ©cifique, mais il est recommandÃ© de garder les messages individuels sous 64 Ko.',
                    relatedTools: 'ğŸ”— Outils connexes',
                    jsonViewer: 'Visualiseur JSON',
                    jsonViewerDesc: 'Formatage et visualisation JSON',
                    cryptoTools: 'BoÃ®te Ã  outils crypto',
                    cryptoToolsDesc: 'Base64/MD5/AES etc.',
                    ipLookup: 'Recherche IP',
                    ipLookupDesc: 'RequÃªte de gÃ©olocalisation IP',
                    regexTester: 'Testeur Regex',
                    regexTesterDesc: 'Correspondance et dÃ©bogage regex en ligne',
                    footerNote: 'Traitement purement frontend, les donnÃ©es ne seront pas tÃ©lÃ©chargÃ©es sur le serveur',
                    footerBackHome: 'â† Retour Ã  l\'accueil Web Toolbox',
                    // æ—¥å¿—æ¶ˆæ¯
                    logConnecting: 'Connexion Ã ',
                    logConnected: 'ConnectÃ© avec succÃ¨s !',
                    logDisconnecting: 'DÃ©connexion...',
                    logConnectionClosed: 'Connexion fermÃ©e',
                    logConnectionError: 'Erreur de connexion',
                    logSendFailed: 'Ã‰chec de l\'envoi :',
                    logConnectFailed: 'Ã‰chec de la connexion :',
                    logUserDisconnect: 'Utilisateur dÃ©connectÃ©',
                    logDirectionSent: 'EnvoyÃ© â†’',
                    logDirectionReceived: 'â† ReÃ§u',
                    logDirectionSystem: 'SystÃ¨me',
                    logDirectionError: 'Erreur',
                    // Toast æ¶ˆæ¯
                    toastEnterValidUrl: 'Veuillez entrer une adresse WebSocket valide',
                    toastNotConnected: 'WebSocket non connectÃ©',
                    toastEnterMessage: 'Veuillez entrer le contenu du message',
                    toastInvalidJson: 'Format JSON invalide',
                    langName: 'ğŸŒ FranÃ§ais'
                },
                es: {
                    backHome: 'â† Volver a la caja de herramientas',
                    pageTitle: 'ğŸ”Œ Probador WebSocket en lÃ­nea',
                    pageSubtitle: 'Herramienta de depuraciÃ³n en lÃ­nea basada en HTML5 WebSocket, soporta pruebas de conexiÃ³n internas y externas',
                    connectionFormat: 'Formato de conexiÃ³n:',
                    or: 'o',
                    example: 'Ejemplo:',
                    featureConnectionTitle: 'Prueba de conexiÃ³n',
                    featureConnectionDesc: 'Prueba rÃ¡pidamente el estado de conexiÃ³n del servidor WebSocket, soporta protocolos ws:// y wss://',
                    featureMessagingTitle: 'MensajerÃ­a',
                    featureMessagingDesc: 'Soporta envÃ­o de mensajes de texto y formato JSON, muestra en tiempo real las respuestas del servidor',
                    featureHistoryTitle: 'Historial de conexiÃ³n',
                    featureHistoryDesc: 'Guarda automÃ¡ticamente los registros de conexiÃ³n para pruebas repetidas convenientes de la misma direcciÃ³n WebSocket',
                    featureFormatTitle: 'Formateo de mensajes',
                    featureFormatDesc: 'Detecta y formatea automÃ¡ticamente mensajes JSON para datos de depuraciÃ³n mÃ¡s claros y legibles',
                    connectionSettings: 'ğŸ”— ConfiguraciÃ³n de conexiÃ³n',
                    statusDisconnected: 'Desconectado',
                    statusConnecting: 'Conectando...',
                    statusConnected: 'Conectado',
                    urlPlaceholder: '127.0.0.1:8080/ws',
                    connect: 'Conectar',
                    disconnect: 'Desconectar',
                    statSent: 'Enviados',
                    statReceived: 'Recibidos',
                    statErrors: 'Errores',
                    statDuration: 'DuraciÃ³n',
                    sendMessage: 'ğŸ“¤ Enviar mensaje',
                    messagePlaceholder: 'Ingrese el contenido del mensaje a enviar...',
                    msgTypeText: 'Texto',
                    formatJson: 'Formatear JSON',
                    clear: 'Limpiar',
                    send: 'Enviar',
                    quickMessages: 'Mensajes rÃ¡pidos',
                    messageLog: 'ğŸ“‹ Registro de mensajes',
                    clearLog: 'Limpiar',
                    noMessages: 'Sin mensajes aÃºn',
                    noMessagesHint: 'Los mensajes aparecerÃ¡n aquÃ­ despuÃ©s de conectar al WebSocket',
                    usageGuide: 'ğŸ“– GuÃ­a de uso',
                    usageNote1: 'Soporta protocolos <code>ws://</code> (regular) y <code>wss://</code> (encriptado SSL)',
                    usageNote2: 'Prueba interna: <code>ws://192.168.1.100:8080</code> o <code>ws://localhost:3000</code>',
                    usageNote3: 'Prueba externa: <code>wss://example.com/ws</code> o <code>ws://your-domain.com:8080</code>',
                    usageNote4: 'Soporta envÃ­o de mensajes de texto plano y formato JSON, con formateo JSON automÃ¡tico',
                    usageNote5: 'VisualizaciÃ³n en tiempo real de mensajes enviados/recibidos con marcas de tiempo y contenido',
                    usageNote6: 'Monitoreo de estado de conexiÃ³n en tiempo real, estadÃ­sticas de enviados/recibidos/errores',
                    faqTitle: 'â“ Preguntas frecuentes',
                    faq1Question: 'Â¿QuÃ© es WebSocket?',
                    faq1Answer: 'WebSocket es un protocolo de comunicaciÃ³n full-duplex que permite al servidor enviar datos al cliente de manera proactiva. A diferencia del modo tradicional de solicitud-respuesta HTTP, WebSocket puede comunicarse bidireccionalmente en tiempo real despuÃ©s de establecer una conexiÃ³n, adecuado para chat, transmisiÃ³n de datos en tiempo real, juegos en lÃ­nea, etc.',
                    faq2Question: 'Â¿CuÃ¡l es la diferencia entre ws y wss?',
                    faq2Answer: 'ws es el protocolo WebSocket regular, wss es el WebSocket encriptado (similar a la relaciÃ³n entre <code>http</code> y <code>https</code>). wss usa TLS/SSL para encriptar la transmisiÃ³n de datos, lo que es mÃ¡s seguro. Se recomienda usar el protocolo wss en entornos de producciÃ³n.',
                    faq3Question: 'Â¿Por quÃ© falla la conexiÃ³n WebSocket?',
                    faq3Answer: 'Las razones comunes incluyen: direcciÃ³n incorrecta, servidor no iniciado, bloqueo de firewall, restricciones CORS, problemas de certificado SSL (protocolo wss), puerto ocupado, etc. Se recomienda verificar el estado del servidor y la conexiÃ³n de red para asegurar que el servicio WebSocket funcione normalmente.',
                    faq4Question: 'Â¿Puedo probar WebSocket que requiere autenticaciÃ³n?',
                    faq4Answer: 'Esta herramienta no soporta conexiones WebSocket que requieren autenticaciÃ³n. Solo soporta pruebas de conexiÃ³n WebSocket sin autenticaciÃ³n. Para conexiones autenticadas, se recomienda usar herramientas cliente WebSocket profesionales como Postman o wscat.',
                    faq5Question: 'Â¿Hay restricciones en el formato de mensajes?',
                    faq5Answer: 'Se soporta cualquier mensaje de texto, el formato JSON se formatearÃ¡ automÃ¡ticamente para su visualizaciÃ³n. La herramienta detecta automÃ¡ticamente el formato JSON y lo embellece para facilitar la depuraciÃ³n de la interfaz API. No hay lÃ­mite especÃ­fico de longitud de mensaje, pero se recomienda mantener mensajes individuales por debajo de 64KB.',
                    relatedTools: 'ğŸ”— Herramientas relacionadas',
                    jsonViewer: 'Visor JSON',
                    jsonViewerDesc: 'Formateo y visualizaciÃ³n JSON',
                    cryptoTools: 'Caja de herramientas crypto',
                    cryptoToolsDesc: 'Base64/MD5/AES etc.',
                    ipLookup: 'BÃºsqueda de IP',
                    ipLookupDesc: 'Consulta de geolocalizaciÃ³n IP',
                    regexTester: 'Probador Regex',
                    regexTesterDesc: 'Coincidencia y depuraciÃ³n regex en lÃ­nea',
                    footerNote: 'Procesamiento puramente frontend, los datos no se subirÃ¡n al servidor',
                    footerBackHome: 'â† Volver a la pÃ¡gina principal de Web Toolbox',
                    // æ—¥å¿—æ¶ˆæ¯
                    logConnecting: 'Conectando a',
                    logConnected: 'Â¡Conectado exitosamente!',
                    logDisconnecting: 'Desconectando...',
                    logConnectionClosed: 'ConexiÃ³n cerrada',
                    logConnectionError: 'Error de conexiÃ³n',
                    logSendFailed: 'Error de envÃ­o:',
                    logConnectFailed: 'Error de conexiÃ³n:',
                    logUserDisconnect: 'Usuario desconectado',
                    logDirectionSent: 'Enviado â†’',
                    logDirectionReceived: 'â† Recibido',
                    logDirectionSystem: 'Sistema',
                    logDirectionError: 'Error',
                    // Toast æ¶ˆæ¯
                    toastEnterValidUrl: 'Por favor ingrese una direcciÃ³n WebSocket vÃ¡lida',
                    toastNotConnected: 'WebSocket no conectado',
                    toastEnterMessage: 'Por favor ingrese el contenido del mensaje',
                    toastInvalidJson: 'Formato JSON invÃ¡lido',
                    langName: 'ğŸŒ EspaÃ±ol'
                }
            },

            t(key) {
                return this.translations[this.currentLang]?.[key] || this.translations['en'][key] || key;
            },

            setLang(lang) {
                if (this.translations[lang]) {
                    this.currentLang = lang;
                    localStorage.setItem('websocket-tester-lang', lang);
                    this.updateUI();
                }
            },

            updateUI() {
                // æ›´æ–°æ‰€æœ‰å¸¦ data-i18n å±æ€§çš„å…ƒç´ 
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    const translation = this.t(key);
                    if (translation) {
                        el.innerHTML = translation;
                    }
                });

                // æ›´æ–°æ‰€æœ‰å¸¦ data-i18n-placeholder å±æ€§çš„å…ƒç´ 
                document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                    const key = el.getAttribute('data-i18n-placeholder');
                    const translation = this.t(key);
                    if (translation) {
                        el.placeholder = translation;
                    }
                });

                // æ›´æ–°è¯­è¨€åˆ‡æ¢å™¨æ˜¾ç¤º
                document.getElementById('langCurrent').textContent = this.t('langName');
            },

            init() {
                // ä» localStorage è¯»å–ä¿å­˜çš„è¯­è¨€è®¾ç½®
                const savedLang = localStorage.getItem('websocket-tester-lang');
                if (savedLang && this.translations[savedLang]) {
                    this.currentLang = savedLang;
                } else {
                    // æ ¹æ®æµè§ˆå™¨è¯­è¨€è‡ªåŠ¨é€‰æ‹©
                    const browserLang = navigator.language || navigator.userLanguage;
                    if (browserLang.startsWith('zh')) {
                        this.currentLang = 'zh-CN';
                    } else if (browserLang.startsWith('fr')) {
                        this.currentLang = 'fr';
                    } else if (browserLang.startsWith('es')) {
                        this.currentLang = 'es';
                    } else {
                        this.currentLang = 'en';
                    }
                }
                this.updateUI();
            }
        };

        // è¯­è¨€åˆ‡æ¢å™¨äº¤äº’
        document.getElementById('langDropdown').addEventListener('click', function(e) {
            this.classList.toggle('active');
            e.stopPropagation();
        });

        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                const lang = this.getAttribute('data-lang');
                i18n.setLang(lang);
                document.getElementById('langDropdown').classList.remove('active');
                e.stopPropagation();
            });
        });

        document.addEventListener('click', function() {
            document.getElementById('langDropdown').classList.remove('active');
        });

        // åˆå§‹åŒ– i18n
        i18n.init();

        // ==================== WebSocket æ¨¡å— ====================

        // WebSocket å®ä¾‹
        let ws = null;
        let connectedAt = null;
        let timerInterval = null;

        // ç»Ÿè®¡æ•°æ®
        let stats = {
            sent: 0,
            received: 0,
            errors: 0
        };

        // æ›´æ–°åè®®æ ‡ç­¾
        function updateProtocol() {
            const protocol = document.querySelector('input[name="protocol"]:checked').value;
            document.getElementById('protocolLabel').textContent = protocol;
        }

        // è·å–å®Œæ•´ URL
        function getFullUrl() {
            const protocol = document.querySelector('input[name="protocol"]:checked').value;
            let url = document.getElementById('wsUrl').value.trim();
            // ç§»é™¤å¯èƒ½å·²æœ‰çš„åè®®å‰ç¼€
            url = url.replace(/^wss?:\/\//, '');
            return protocol + url;
        }

        // è¿æ¥ WebSocket
        function connect() {
            const url = getFullUrl();

            if (!url || url === 'ws://' || url === 'wss://') {
                showToast(i18n.t('toastEnterValidUrl'), true);
                return;
            }

            try {
                updateStatus('connecting');
                addLog('system', `${i18n.t('logConnecting')} ${url}...`);

                ws = new WebSocket(url);

                ws.onopen = function(event) {
                    updateStatus('connected');
                    addLog('system', i18n.t('logConnected'));
                    connectedAt = new Date();
                    startTimer();
                    saveToHistory(url);
                };

                ws.onmessage = function(event) {
                    stats.received++;
                    updateStats();
                    addLog('received', event.data);
                };

                ws.onerror = function(event) {
                    stats.errors++;
                    updateStats();
                    addLog('error', i18n.t('logConnectionError'));
                };

                ws.onclose = function(event) {
                    updateStatus('disconnected');
                    stopTimer();
                    let reason = event.reason || i18n.t('logConnectionClosed');
                    if (event.code) {
                        reason += ` (code: ${event.code})`;
                    }
                    addLog('system', reason);
                };

            } catch (e) {
                updateStatus('disconnected');
                addLog('error', i18n.t('logConnectFailed') + e.message);
                showToast(i18n.t('logConnectFailed') + e.message, true);
            }
        }

        // æ–­å¼€è¿æ¥
        function disconnect() {
            if (ws) {
                addLog('system', i18n.t('logDisconnecting'));
                try {
                    ws.close(1000, i18n.t('logUserDisconnect'));
                } catch (e) {
                    console.error('Close connection error:', e);
                }
                ws = null;
                updateStatus('disconnected');
                stopTimer();
            }
        }

        // å‘é€æ¶ˆæ¯
        function sendMessage() {
            if (!ws || ws.readyState !== WebSocket.OPEN) {
                showToast(i18n.t('toastNotConnected'), true);
                return;
            }

            const message = document.getElementById('messageInput').value;
            if (!message.trim()) {
                showToast(i18n.t('toastEnterMessage'), true);
                return;
            }

            try {
                ws.send(message);
                stats.sent++;
                updateStats();
                addLog('sent', message);
            } catch (e) {
                stats.errors++;
                updateStats();
                addLog('error', i18n.t('logSendFailed') + e.message);
            }
        }

        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus(status) {
            const dot = document.getElementById('statusDot');
            const text = document.getElementById('statusText');
            const connectBtn = document.getElementById('connectBtn');
            const disconnectBtn = document.getElementById('disconnectBtn');
            const sendBtn = document.getElementById('sendBtn');

            dot.className = 'status-dot ' + status;
            text.className = 'status-text ' + status;

            switch(status) {
                case 'connecting':
                    text.textContent = i18n.t('statusConnecting');
                    connectBtn.disabled = true;
                    disconnectBtn.disabled = true;
                    sendBtn.disabled = true;
                    break;
                case 'connected':
                    text.textContent = i18n.t('statusConnected');
                    connectBtn.disabled = true;
                    disconnectBtn.disabled = false;
                    sendBtn.disabled = false;
                    break;
                case 'disconnected':
                    text.textContent = i18n.t('statusDisconnected');
                    connectBtn.disabled = false;
                    disconnectBtn.disabled = true;
                    sendBtn.disabled = true;
                    break;
            }
        }

        // æ·»åŠ æ—¥å¿—
        function addLog(type, content) {
            const log = document.getElementById('messageLog');
            const empty = log.querySelector('.log-empty');
            if (empty) {
                empty.remove();
            }

            const entry = document.createElement('div');
            entry.className = 'log-entry ' + type;

            const time = new Date().toLocaleTimeString();
            let direction = '';
            switch(type) {
                case 'sent': direction = i18n.t('logDirectionSent'); break;
                case 'received': direction = i18n.t('logDirectionReceived'); break;
                case 'system': direction = i18n.t('logDirectionSystem'); break;
                case 'error': direction = i18n.t('logDirectionError'); break;
            }

            // å°è¯•æ ¼å¼åŒ– JSON
            let displayContent = content;
            try {
                const parsed = JSON.parse(content);
                displayContent = JSON.stringify(parsed, null, 2);
            } catch(e) {
                // ä¸æ˜¯ JSONï¼Œä¿æŒåŸæ ·
            }

            entry.innerHTML = `
                <span class="time">${time}</span>
                <span class="direction">[${direction}]</span>
                <span class="content">${escapeHtml(displayContent)}</span>
            `;

            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // HTML è½¬ä¹‰
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // æ¸…ç©ºæ—¥å¿—
        function clearLog() {
            const log = document.getElementById('messageLog');
            log.innerHTML = `
                <div class="log-empty">
                    <div class="icon">ğŸ“­</div>
                    <p data-i18n="noMessages">${i18n.t('noMessages')}</p>
                    <p style="font-size: 0.8rem; margin-top: 5px;" data-i18n="noMessagesHint">${i18n.t('noMessagesHint')}</p>
                </div>
            `;
        }

        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            document.getElementById('sentCount').textContent = stats.sent;
            document.getElementById('receivedCount').textContent = stats.received;
            document.getElementById('errorCount').textContent = stats.errors;
        }

        // å¼€å§‹è®¡æ—¶å™¨
        function startTimer() {
            timerInterval = setInterval(() => {
                if (connectedAt) {
                    const diff = Math.floor((new Date() - connectedAt) / 1000);
                    const mins = Math.floor(diff / 60).toString().padStart(2, '0');
                    const secs = (diff % 60).toString().padStart(2, '0');
                    document.getElementById('connectedTime').textContent = `${mins}:${secs}`;
                }
            }, 1000);
        }

        // åœæ­¢è®¡æ—¶å™¨
        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            connectedAt = null;
        }

        // æ ¼å¼åŒ– JSON
        function formatJson() {
            const textarea = document.getElementById('messageInput');
            try {
                const parsed = JSON.parse(textarea.value);
                textarea.value = JSON.stringify(parsed, null, 2);
            } catch(e) {
                showToast(i18n.t('toastInvalidJson'), true);
            }
        }

        // æ¸…ç©ºæ¶ˆæ¯è¾“å…¥
        function clearMessage() {
            document.getElementById('messageInput').value = '';
        }

        // è®¾ç½®å¿«æ·æ¶ˆæ¯
        function setQuickMessage(msg) {
            document.getElementById('messageInput').value = msg;
        }

        // ä¿å­˜åˆ°å†å²è®°å½•
        function saveToHistory(url) {
            let history = JSON.parse(localStorage.getItem('ws_history') || '[]');
            // ç§»é™¤é‡å¤é¡¹
            history = history.filter(item => item !== url);
            // æ·»åŠ åˆ°å¼€å¤´
            history.unshift(url);
            // åªä¿ç•™æœ€è¿‘10æ¡
            history = history.slice(0, 10);
            localStorage.setItem('ws_history', JSON.stringify(history));
        }

        // æ˜¾ç¤º Toast
        function showToast(message, isError = false) {
            const toast = document.createElement('div');
            toast.className = 'toast' + (isError ? ' error' : '');
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 2000);
        }

        // å›è½¦å‘é€
        document.getElementById('messageInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                sendMessage();
            }
        });

        // URL è¾“å…¥æ¡†å›è½¦è¿æ¥
        document.getElementById('wsUrl').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                connect();
            }
        });

        // é¡µé¢å…³é—­æ—¶æ–­å¼€è¿æ¥
        window.addEventListener('beforeunload', function() {
            if (ws) {
                ws.close();
            }
        });
    </script>

    <!-- FAQ å¸¸è§é—®é¢˜ -->
    <section class="faq-section" style="max-width: 1000px; margin: 40px auto 0; padding: 24px;">
        <h2 data-i18n="faqTitle">â“ FAQ</h2>
        <div class="faq-item">
            <div class="faq-question" data-i18n="faq1Question">What is WebSocket?</div>
            <div class="faq-answer" data-i18n="faq1Answer">WebSocket is a full-duplex communication protocol that enables the server to push data to the client proactively. Unlike traditional HTTP request-response mode, WebSocket can communicate bidirectionally in real-time after establishing a connection, suitable for chat, real-time data push, online games, etc.</div>
        </div>
        <div class="faq-item">
            <div class="faq-question" data-i18n="faq2Question">What is the difference between ws and wss?</div>
            <div class="faq-answer" data-i18n="faq2Answer">ws is the regular WebSocket protocol, wss is the encrypted WebSocket (similar to the relationship between <code>http</code> and <code>https</code>). wss uses TLS/SSL to encrypt data transmission, which is more secure. It is recommended to use wss protocol in production environments.</div>
        </div>
        <div class="faq-item">
            <div class="faq-question" data-i18n="faq3Question">Why does WebSocket connection fail?</div>
            <div class="faq-answer" data-i18n="faq3Answer">Common reasons include: incorrect address, server not started, firewall blocking, CORS restrictions, SSL certificate issues (wss protocol), port occupied, etc. It is recommended to check the server status and network connection to ensure the WebSocket service is running normally.</div>
        </div>
        <div class="faq-item">
            <div class="faq-question" data-i18n="faq4Question">Can I test WebSocket that requires authentication?</div>
            <div class="faq-answer" data-i18n="faq4Answer">This tool does not support WebSocket connections that require authentication. It only supports non-authenticated WebSocket connection testing. For authenticated connections, it is recommended to use professional WebSocket client tools like Postman or wscat.</div>
        </div>
        <div class="faq-item">
            <div class="faq-question" data-i18n="faq5Question">Are there any message format restrictions?</div>
            <div class="faq-answer" data-i18n="faq5Answer">Any text message is supported, JSON format will be automatically formatted for display. The tool automatically detects JSON format and beautifies it for easy API interface debugging. There is no specific message length limit, but it is recommended to keep single messages under 64KB.</div>
        </div>
    </section>

    <!-- ç›¸å…³å·¥å…·æ¨è -->
    <section class="related-tools" style="max-width: 1000px; margin: 40px auto; padding: 0 20px;">
        <h3 style="color: #f0f0f0; font-size: 18px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #333;" data-i18n="relatedTools">ğŸ”— Related Tools</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            <a href="json-viewer.html" style="display: block; padding: 16px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                <div style="font-size: 24px; margin-bottom: 8px;">{ }</div>
                <div style="color: #f0f0f0; font-weight: 500;" data-i18n="jsonViewer">JSON Viewer</div>
                <div style="color: #94a3b8; font-size: 12px; margin-top: 4px;" data-i18n="jsonViewerDesc">JSON formatting and visualization</div>
            </a>
            <a href="crypto-tools.html" style="display: block; padding: 16px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ”</div>
                <div style="color: #f0f0f0; font-weight: 500;" data-i18n="cryptoTools">Crypto Toolbox</div>
                <div style="color: #94a3b8; font-size: 12px; margin-top: 4px;" data-i18n="cryptoToolsDesc">Base64/MD5/AES etc.</div>
            </a>
            <a href="ip-lookup.html" style="display: block; padding: 16px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                <div style="font-size: 24px; margin-bottom: 8px;">ğŸŒ</div>
                <div style="color: #f0f0f0; font-weight: 500;" data-i18n="ipLookup">IP Lookup</div>
                <div style="color: #94a3b8; font-size: 12px; margin-top: 4px;" data-i18n="ipLookupDesc">Query IP geolocation</div>
            </a>
            <a href="regex-tester.html" style="display: block; padding: 16px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ”</div>
                <div style="color: #f0f0f0; font-weight: 500;" data-i18n="regexTester">Regex Tester</div>
                <div style="color: #94a3b8; font-size: 12px; margin-top: 4px;" data-i18n="regexTesterDesc">Online regex matching and debugging</div>
            </a>
        </div>
    </section>

    <footer style="text-align: center; padding: 30px 20px; border-top: 1px solid #333; color: #94a3b8; font-size: 14px;">
        <p data-i18n="footerNote">Pure frontend processing, data will not be uploaded to server</p>
        <p style="margin-top: 12px;">
            <a href="index.html" style="color: #7c3aed; text-decoration: none;" data-i18n="footerBackHome">â† Back to Web Toolbox Home</a>
            <span style="margin: 0 12px;">|</span>
            <a href="https://github.com/heyuan110" target="_blank" rel="noopener" style="color: #7c3aed; text-decoration: none;">GitHub</a>
        </p>
    </footer>
</body>
</html>
