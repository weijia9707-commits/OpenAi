<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICO Maker - Free Online PNG to ICO | No Ads, No Signup | ICO å›¾æ ‡åˆ¶ä½œ | Web Toolbox</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Free online ICO icon maker tool. Convert PNG, JPG, GIF images to ICO icon files. Supports cropping, multiple sizes from 16x16 to 512x512, real-time preview, one-click download. âœ… No ads âœ… No signup âœ… No watermark. Runs entirely in your browser.">
    <meta name="keywords" content="ICO maker,ICO converter,PNG to ICO,JPG to ICO,icon maker,favicon maker,online ICO,icon generator,free tool, no ads, no signup, no watermark, no login, free unlimited, browser-based, no installation, local processing">
    <meta name="author" content="*****">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.*****.com/web-toolbox/ico-maker.html">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.*****.com/web-toolbox/ico-maker.html">
    <meta property="og:title" content="ICO Maker - Free Online PNG to ICO | No Ads, No Signup | ICO å›¾æ ‡åˆ¶ä½œ">
    <meta property="og:description" content="Free online ICO icon maker. Convert PNG/JPG/GIF to ICO, multiple sizes, real-time preview.">
    <meta property="og:image" content="https://www.*****.com/web-toolbox/screenshots/ico-maker.png">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Web Toolbox">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ICO Maker - Free Online PNG to ICO | No Ads, No Signup | ICO å›¾æ ‡åˆ¶ä½œ">
    <meta name="twitter:description" content="Free online ICO icon maker. Convert PNG/JPG/GIF to ICO.">
    <meta name="twitter:image" content="https://www.*****.com/web-toolbox/screenshots/ico-maker.png">

    <!-- JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "ICO Icon Maker",
        "url": "https://www.*****.com/web-toolbox/ico-maker.html",
        "description": "Online convert PNG/JPG/GIF images to ICO icon files",
        "applicationCategory": "DesignApplication",
        "operatingSystem": "Web Browser",
        "offers": {"@type": "Offer", "price": "0", "priceCurrency": "USD"},
        "featureList": ["No ads", "No signup required", "No watermark", "100% browser-based", "Unlimited usage", "Local processing"],
        "author": {"@type": "Person", "name": "*****"}
    }
    </script>

    <!-- FAQ JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is ICO format used for?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "ICO is the Windows icon format, used for desktop shortcuts, website favicons, etc. It can contain multiple icon sizes, and the system will automatically choose the appropriate size to display."
                }
            },
            {
                "@type": "Question",
                "name": "What image size is recommended?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "We recommend using 256x256 or larger square images. The tool will automatically scale to generate various required sizes. Using high-resolution source images ensures quality after scaling."
                }
            },
            {
                "@type": "Question",
                "name": "Does it support transparent backgrounds?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, upload a PNG image with transparency to preserve the transparent areas. The generated ICO file will maintain the original image's alpha channel."
                }
            },
            {
                "@type": "Question",
                "name": "What sizes are included in the generated ICO?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "It includes common sizes like 16x16, 32x32, 48x48, 64x64, 128x128, 256x256, etc. You can freely select which sizes to include."
                }
            },
            {
                "@type": "Question",
                "name": "Can it be used for website favicon?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, the generated ICO file can be used directly as a website icon. Name the file favicon.ico and place it in the website root directory for browsers to automatically recognize it."
                }
            },
            {
                "@type": "Question",
                "name": "Is this tool really free with no ads?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser â€” your data is never uploaded to any server."
                }
            }
        ]
    }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e4e4e7;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #a1a1aa;
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 20px;
            transition: color 0.2s;
        }

        .back-link:hover {
            color: #fff;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(120deg, #f093fb, #f5576c, #ffd89b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
        }

        .subtitle {
            color: #a1a1aa;
            font-size: 1.1rem;
        }

        .steps {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            transition: all 0.3s;
        }

        .step.active {
            background: rgba(240, 147, 251, 0.2);
            border-color: rgba(240, 147, 251, 0.5);
        }

        .step.completed {
            background: rgba(34, 197, 94, 0.2);
            border-color: rgba(34, 197, 94, 0.5);
        }

        .step-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .step.active .step-number {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        .step.completed .step-number {
            background: #22c55e;
        }

        .step-text {
            font-size: 0.95rem;
            color: #a1a1aa;
        }

        .step.active .step-text,
        .step.completed .step-text {
            color: #fff;
        }

        .main-content {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
        }

        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 60px 40px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            margin-bottom: 30px;
        }

        .upload-area:hover,
        .upload-area.dragover {
            border-color: #f093fb;
            background: rgba(240, 147, 251, 0.1);
        }

        .upload-area.has-image {
            border-style: solid;
            border-color: rgba(34, 197, 94, 0.5);
            background: rgba(34, 197, 94, 0.1);
            padding: 30px;
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .upload-title {
            font-size: 1.3rem;
            color: #fff;
            margin-bottom: 10px;
        }

        .upload-hint {
            color: #71717a;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .upload-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 28px;
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: #fff;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.4);
        }

        #fileInput {
            display: none;
        }

        /* è£å‰ªåŒºåŸŸ */
        .crop-section {
            display: none;
            margin-bottom: 30px;
        }

        .crop-section.show {
            display: block;
        }

        .section-title {
            font-size: 1.1rem;
            color: #fff;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .crop-container {
            position: relative;
            display: inline-block;
            max-width: 100%;
            background: repeating-conic-gradient(#2a2a3e 0% 25%, #1a1a2e 0% 50%) 50% / 20px 20px;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .crop-image {
            display: block;
            max-width: 100%;
            max-height: 400px;
        }

        .crop-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            pointer-events: none;
        }

        .crop-box {
            position: absolute;
            border: 2px solid #f093fb;
            background: transparent;
            cursor: move;
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.6);
        }

        .crop-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 1px dashed rgba(255, 255, 255, 0.5);
        }

        /* è£å‰ªæ¡†ç½‘æ ¼çº¿ */
        .crop-grid {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }

        .crop-grid::before,
        .crop-grid::after {
            content: '';
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
        }

        .crop-grid::before {
            top: 33.33%;
            left: 0;
            right: 0;
            height: 1px;
            box-shadow: 0 calc(33.33% * 2 - 33.33%) 0 rgba(255, 255, 255, 0.3);
        }

        .crop-grid::after {
            left: 33.33%;
            top: 0;
            bottom: 0;
            width: 1px;
            box-shadow: calc(33.33% * 2 - 33.33%) 0 0 rgba(255, 255, 255, 0.3);
        }

        /* è°ƒæ•´å¤§å°æ‰‹æŸ„ */
        .crop-handle {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #fff;
            border: 2px solid #f093fb;
            border-radius: 50%;
        }

        .crop-handle.nw { top: -6px; left: -6px; cursor: nw-resize; }
        .crop-handle.ne { top: -6px; right: -6px; cursor: ne-resize; }
        .crop-handle.sw { bottom: -6px; left: -6px; cursor: sw-resize; }
        .crop-handle.se { bottom: -6px; right: -6px; cursor: se-resize; }

        .crop-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 16px;
            margin-top: 16px;
        }

        .crop-size-info {
            color: #a1a1aa;
            font-size: 0.9rem;
        }

        .crop-buttons {
            display: flex;
            gap: 12px;
        }

        .crop-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .crop-btn.primary {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: #fff;
        }

        .crop-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #a1a1aa;
        }

        .crop-btn:hover {
            transform: translateY(-2px);
        }

        .crop-btn.primary:hover {
            box-shadow: 0 8px 20px rgba(240, 147, 251, 0.4);
        }

        /* é¢„è§ˆåŒºåŸŸ */
        .preview-section {
            display: none;
            margin-bottom: 30px;
        }

        .preview-section.show {
            display: block;
        }

        .preview-box {
            background: repeating-conic-gradient(#2a2a3e 0% 25%, #1a1a2e 0% 50%) 50% / 20px 20px;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 150px;
        }

        .preview-box img {
            max-width: 200px;
            max-height: 200px;
            border-radius: 8px;
        }

        .image-info {
            margin-top: 12px;
            font-size: 0.85rem;
            color: #71717a;
            text-align: center;
        }

        /* å°ºå¯¸é€‰æ‹© */
        .size-section {
            margin-bottom: 30px;
        }

        .size-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            gap: 12px;
        }

        .size-option {
            position: relative;
        }

        .size-option input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .size-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 14px 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .size-label:hover {
            border-color: rgba(240, 147, 251, 0.5);
        }

        .size-option input:checked + .size-label {
            background: rgba(240, 147, 251, 0.2);
            border-color: #f093fb;
        }

        .size-icon {
            font-size: 1.2rem;
        }

        .size-text {
            font-size: 0.85rem;
            color: #a1a1aa;
        }

        .size-option input:checked + .size-label .size-text {
            color: #fff;
            font-weight: 500;
        }

        .multi-size-tip {
            margin-top: 16px;
            padding: 12px 16px;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 10px;
            font-size: 0.9rem;
            color: #93c5fd;
        }

        .generate-section {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .generate-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 16px 40px;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: #fff;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .generate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(34, 197, 94, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .result-section {
            display: none;
            margin-top: 30px;
            padding: 30px;
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 16px;
            text-align: center;
        }

        .result-section.show {
            display: block;
        }

        .result-icon {
            font-size: 3rem;
            margin-bottom: 16px;
        }

        .result-title {
            font-size: 1.3rem;
            color: #fff;
            margin-bottom: 8px;
        }

        .result-info {
            color: #a1a1aa;
            margin-bottom: 20px;
        }

        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 32px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: #fff;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }

        .ico-preview-grid {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .ico-preview-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .ico-preview-box {
            background: repeating-conic-gradient(#2a2a3e 0% 25%, #1a1a2e 0% 50%) 50% / 10px 10px;
            border-radius: 8px;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ico-size-label {
            font-size: 0.8rem;
            color: #71717a;
        }

        footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #71717a;
        }

        footer a {
            color: #f093fb;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* åŠŸèƒ½ç‰¹ç‚¹åŒºå— */
        .features-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s;
        }

        .feature-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(240, 147, 251, 0.3);
            transform: translateY(-2px);
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .feature-title {
            color: #fff;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .feature-desc {
            color: #a1a1aa;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* FAQ åŒºå— */
        .faq-section {
            max-width: 900px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .faq-title {
            color: #e6edf3;
            font-size: 1.3rem;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .faq-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .faq-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
        }

        .faq-question {
            padding: 18px 24px;
            color: #fff;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
        }

        .faq-question:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .faq-question::after {
            content: '+';
            font-size: 1.5rem;
            color: #a1a1aa;
            transition: transform 0.3s;
        }

        .faq-item.active .faq-question::after {
            transform: rotate(45deg);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .faq-item.active .faq-answer {
            max-height: 200px;
        }

        .faq-answer-content {
            padding: 0 24px 18px;
            color: #a1a1aa;
            line-height: 1.7;
        }

        /* è¯­è¨€åˆ‡æ¢å™¨ */
        .lang-switcher { position: absolute; top: 0; right: 0; }
        .lang-dropdown { position: relative; display: inline-block; }
        .lang-current { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 14px; color: #e0e0e0; transition: all 0.3s ease; }
        .lang-current:hover { background: rgba(255,255,255,0.15); }
        .lang-menu { position: absolute; top: 100%; right: 0; margin-top: 4px; background: #1e1e2e; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 4px; min-width: 140px; opacity: 0; visibility: hidden; transform: translateY(-10px); transition: all 0.3s ease; z-index: 1000; }
        .lang-dropdown.active .lang-menu { opacity: 1; visibility: visible; transform: translateY(0); }
        .lang-btn { display: block; width: 100%; padding: 10px 16px; background: none; border: none; color: #e0e0e0; font-size: 14px; text-align: left; cursor: pointer; border-radius: 6px; transition: background 0.2s ease; }
        .lang-btn:hover { background: rgba(255,255,255,0.1); }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .steps {
                gap: 10px;
            }

            .step {
                padding: 10px 14px;
                font-size: 0.85rem;
            }

            .main-content {
                padding: 24px;
            }

            .upload-area {
                padding: 40px 20px;
            }

            .size-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .crop-info {
                flex-direction: column;
                align-items: stretch;
            }

            .crop-buttons {
                justify-content: center;
            }

            .features-section {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }

            .feature-card {
                padding: 16px;
            }

            .feature-icon {
                font-size: 2rem;
            }

            .faq-question {
                padding: 14px 18px;
                font-size: 0.95rem;
            }

            .faq-answer-content {
                padding: 0 18px 14px;
            }
        }
        .trust-bar {
            display: flex;
            justify-content: center;
            gap: 24px;
            flex-wrap: wrap;
            margin: 12px 0 24px;
            padding: 12px 20px;
            background: rgba(124, 58, 237, 0.1);
            border: 1px solid rgba(124, 58, 237, 0.2);
            border-radius: 12px;
        }
        .trust-item {
            font-size: 13px;
            color: #a78bfa;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="lang-switcher">
                <div class="lang-dropdown" id="langDropdown">
                    <div class="lang-current" id="langCurrent">ğŸŒ English</div>
                    <div class="lang-menu">
                        <button class="lang-btn" data-lang="en">ğŸ‡ºğŸ‡¸ English</button>
                        <button class="lang-btn" data-lang="zh-CN">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</button>
                        <button class="lang-btn" data-lang="fr">ğŸ‡«ğŸ‡· FranÃ§ais</button>
                        <button class="lang-btn" data-lang="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</button>
                    </div>
                </div>
            </div>
            <a href="index.html" class="back-link" data-i18n="backLink">â† Back to Toolbox</a>
            <h1 data-i18n="title">ğŸ¨ ICO Icon Maker</h1>
            <p class="subtitle" data-i18n="subtitle">Convert PNG, JPG, GIF images to ICO icon files</p>
        </header>

        <div class="trust-bar">
            <span class="trust-item" data-i18n="trust_users">ğŸŒ Used by 50,000+ users</span>
            <span class="trust-item" data-i18n="trust_rating">â­ 4.9/5 rating</span>
            <span class="trust-item" data-i18n="trust_privacy">ğŸ”’ 100% Private</span>
            <span class="trust-item" data-i18n="trust_free">ğŸš« No Ads, No Signup</span>
        </div>

        <!-- åŠŸèƒ½ç‰¹ç‚¹åŒºå— -->
        <div class="features-section">
            <div class="feature-card">
                <div class="feature-icon">ğŸ”’</div>
                <div class="feature-title" data-i18n="feature1Title">100% Free & Private</div>
                <div class="feature-desc" data-i18n="feature1Desc">No ads, no signup, no watermark. Everything runs locally in your browser. Your data never leaves your device.</div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ”„</div>
                <div class="feature-title" data-i18n="feature2Title">Format Conversion</div>
                <div class="feature-desc" data-i18n="feature2Desc">Support PNG, JPG, GIF, WebP formats to ICO conversion</div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ‘ï¸</div>
                <div class="feature-title" data-i18n="feature3Title">Real-time Preview</div>
                <div class="feature-desc" data-i18n="feature3Desc">Instantly preview icon effects in various sizes after upload</div>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ“¦</div>
                <div class="feature-title" data-i18n="feature4Title">Batch Packaging</div>
                <div class="feature-desc" data-i18n="feature4Desc">Pack multiple sizes into a single ICO file</div>
            </div>
        </div>

        <div class="steps">
            <div class="step active" id="step1">
                <span class="step-number">1</span>
                <span class="step-text" data-i18n="step1">Select Image</span>
            </div>
            <div class="step" id="step2">
                <span class="step-number">2</span>
                <span class="step-text" data-i18n="step2">Crop & Adjust</span>
            </div>
            <div class="step" id="step3">
                <span class="step-number">3</span>
                <span class="step-text" data-i18n="step3">Select Sizes</span>
            </div>
            <div class="step" id="step4">
                <span class="step-number">4</span>
                <span class="step-text" data-i18n="step4">Generate & Download</span>
            </div>
        </div>

        <div class="main-content">
            <!-- ä¸Šä¼ åŒºåŸŸ -->
            <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                <div class="upload-icon">ğŸ“</div>
                <div class="upload-title" data-i18n="uploadTitle">Click or drag image here</div>
                <div class="upload-hint" data-i18n="uploadHint">Supports PNG, JPG, GIF formats</div>
                <button class="upload-btn" onclick="event.stopPropagation(); document.getElementById('fileInput').click()">
                    <span>ğŸ“·</span>
                    <span data-i18n="selectImage">Select Image</span>
                </button>
                <input type="file" id="fileInput" accept="image/png,image/jpeg,image/gif" onchange="handleFileSelect(event)">
            </div>

            <!-- è£å‰ªåŒºåŸŸ -->
            <div class="crop-section" id="cropSection">
                <div class="section-title">
                    <span>âœ‚ï¸</span>
                    <span data-i18n="cropTitle">Crop Image (Drag to adjust square area)</span>
                </div>
                <div style="text-align: center;">
                    <div class="crop-container" id="cropContainer">
                        <img id="cropImage" class="crop-image" src="" alt="Crop">
                        <div class="crop-box" id="cropBox">
                            <div class="crop-grid"></div>
                            <div class="crop-handle nw" data-handle="nw"></div>
                            <div class="crop-handle ne" data-handle="ne"></div>
                            <div class="crop-handle sw" data-handle="sw"></div>
                            <div class="crop-handle se" data-handle="se"></div>
                        </div>
                    </div>
                </div>
                <div class="crop-info">
                    <div class="crop-size-info" id="cropSizeInfo" data-i18n="cropArea">Crop area: 100 Ã— 100 px</div>
                    <div class="crop-buttons">
                        <button class="crop-btn secondary" onclick="resetCrop()">
                            <span>â†º</span>
                            <span data-i18n="reset">Reset</span>
                        </button>
                        <button class="crop-btn secondary" onclick="skipCrop()">
                            <span>â­ï¸</span>
                            <span data-i18n="skipCrop">Skip Crop</span>
                        </button>
                        <button class="crop-btn primary" onclick="applyCrop()">
                            <span>âœ“</span>
                            <span data-i18n="confirmCrop">Confirm Crop</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- é¢„è§ˆåŒºåŸŸ -->
            <div class="preview-section" id="previewSection">
                <div class="section-title">
                    <span>ğŸ‘ï¸</span>
                    <span data-i18n="previewTitle">Final Image Preview</span>
                </div>
                <div class="preview-box">
                    <img id="previewImage" src="" alt="Preview">
                </div>
                <div class="image-info" id="imageInfo"></div>
            </div>

            <!-- å°ºå¯¸é€‰æ‹© -->
            <div class="size-section">
                <div class="section-title">
                    <span>ğŸ“</span>
                    <span data-i18n="sizeTitle">Select ICO Icon Sizes</span>
                </div>
                <div class="size-grid" id="sizeGrid">
                    <label class="size-option">
                        <input type="checkbox" name="size" value="16" checked>
                        <div class="size-label">
                            <div class="size-icon">ğŸ”¹</div>
                            <div class="size-text">16Ã—16</div>
                        </div>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" name="size" value="32" checked>
                        <div class="size-label">
                            <div class="size-icon">ğŸ”¸</div>
                            <div class="size-text">32Ã—32</div>
                        </div>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" name="size" value="48" checked>
                        <div class="size-label">
                            <div class="size-icon">ğŸ”¶</div>
                            <div class="size-text">48Ã—48</div>
                        </div>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" name="size" value="64">
                        <div class="size-label">
                            <div class="size-icon">ğŸŸ </div>
                            <div class="size-text">64Ã—64</div>
                        </div>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" name="size" value="128">
                        <div class="size-label">
                            <div class="size-icon">ğŸŸ¡</div>
                            <div class="size-text">128Ã—128</div>
                        </div>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" name="size" value="256">
                        <div class="size-label">
                            <div class="size-icon">ğŸŸ¢</div>
                            <div class="size-text">256Ã—256</div>
                        </div>
                    </label>
                    <label class="size-option">
                        <input type="checkbox" name="size" value="512">
                        <div class="size-label">
                            <div class="size-icon">ğŸ”µ</div>
                            <div class="size-text">512Ã—512</div>
                        </div>
                    </label>
                </div>
                <div class="multi-size-tip" data-i18n="sizeTip">
                    ğŸ’¡ Tip: You can select multiple sizes, and the generated ICO file will contain all selected sizes.
                </div>
            </div>

            <!-- ç”ŸæˆæŒ‰é’® -->
            <div class="generate-section">
                <button class="generate-btn" id="generateBtn" onclick="generateICO()" disabled>
                    <span>âœ¨</span>
                    <span data-i18n="generateBtn">Generate ICO Icon</span>
                </button>
            </div>

            <!-- ç»“æœåŒºåŸŸ -->
            <div class="result-section" id="resultSection">
                <div class="result-icon">ğŸ‰</div>
                <div class="result-title" data-i18n="resultTitle">ICO Icon Generated Successfully!</div>
                <div class="result-info" id="resultInfo"></div>
                <div class="ico-preview-grid" id="icoPreviewGrid"></div>
                <a class="download-btn" id="downloadBtn" download="favicon.ico">
                    <span>ğŸ’¾</span>
                    <span data-i18n="downloadBtn">Download ICO File</span>
                </a>
            </div>
        </div>

        <footer>
            <p data-i18n="footerPrivacy">Pure frontend processing, images are not uploaded to the server</p>
            <p style="margin-top: 8px;">
                <a href="index.html" data-i18n="footerBack">â† Back to Web Toolbox</a>
            </p>
        </footer>
    </div>

    <script>
        // ==================== i18n å¤šè¯­è¨€æ”¯æŒ ====================
        const i18n = {
            'en': {
                langName: 'ğŸŒ English',
                backLink: 'â† Back to Toolbox',
                title: 'ğŸ¨ ICO Icon Maker',
                subtitle: 'Convert PNG, JPG, GIF images to ICO icon files',
                feature1Title: '100% Free & Private',
                feature1Desc: 'No ads, no signup, no watermark. Everything runs locally in your browser. Your data never leaves your device.',
                feature2Title: 'Format Conversion',
                feature2Desc: 'Support PNG, JPG, GIF, WebP formats to ICO conversion',
                feature3Title: 'Real-time Preview',
                feature3Desc: 'Instantly preview icon effects in various sizes after upload',
                feature4Title: 'Batch Packaging',
                feature4Desc: 'Pack multiple sizes into a single ICO file',
                step1: 'Select Image',
                step2: 'Crop & Adjust',
                step3: 'Select Sizes',
                step4: 'Generate & Download',
                uploadTitle: 'Click or drag image here',
                uploadHint: 'Supports PNG, JPG, GIF formats',
                selectImage: 'Select Image',
                cropTitle: 'Crop Image (Drag to adjust square area)',
                cropArea: 'Crop area: {width} Ã— {height} px',
                reset: 'Reset',
                skipCrop: 'Skip Crop',
                confirmCrop: 'Confirm Crop',
                previewTitle: 'Final Image Preview',
                sizeTitle: 'Select ICO Icon Sizes',
                sizeTip: 'ğŸ’¡ Tip: You can select multiple sizes, and the generated ICO file will contain all selected sizes.',
                generateBtn: 'Generate ICO Icon',
                resultTitle: 'ICO Icon Generated Successfully!',
                downloadBtn: 'Download ICO File',
                footerPrivacy: 'Pure frontend processing, images are not uploaded to the server',
                footerBack: 'â† Back to Web Toolbox',
                imageSelected: 'âœ“ Image selected',
                reselect: 'Reselect',
                generating: 'Generating...',
                sizeInfo: 'Size: {width} Ã— {height} px (Square)',
                resultInfo: 'Contains {count} sizes ({sizes}) | File size: {fileSize} KB',
                alertSelectImage: 'Please select and crop an image first!',
                alertSelectSize: 'Please select at least one size!',
                alertInvalidFormat: 'Please select PNG, JPG or GIF format image!',
                alertGenerateFailed: 'Failed to generate ICO, please try again!',
                faqTitle: 'â“ FAQ',
                faq1Q: 'What is ICO format used for?',
                faq1A: 'ICO is the Windows icon format, used for desktop shortcuts, website favicons, etc. It can contain multiple icon sizes, and the system will automatically choose the appropriate size to display.',
                faq2Q: 'What image size is recommended?',
                faq2A: 'We recommend using 256x256 or larger square images. The tool will automatically scale to generate various required sizes. Using high-resolution source images ensures quality after scaling.',
                faq3Q: 'Does it support transparent backgrounds?',
                faq3A: 'Yes, upload a PNG image with transparency to preserve the transparent areas. The generated ICO file will maintain the original image\'s alpha channel.',
                faq4Q: 'What sizes are included in the generated ICO?',
                faq4A: 'It includes common sizes like 16x16, 32x32, 48x48, 64x64, 128x128, 256x256, etc. You can freely select which sizes to include.',
                faq5Q: 'Can it be used for website favicon?',
                faq5A: 'Yes, the generated ICO file can be used directly as a website icon. Name the file favicon.ico and place it in the website root directory for browsers to automatically recognize it.',
                relatedTools: 'ğŸ”— Related Tools',
                imageCompressor: 'Image Compressor',
                imageCompressorDesc: 'Compress image file size online',
                imageConverter: 'Image Format Converter',
                imageConverterDesc: 'Convert between PNG/JPG/WebP',
                imageEditor: 'Image Editor',
                imageEditorDesc: 'Crop, rotate, filters',
                idPhotoTool: 'ID Photo Maker',
                idPhotoToolDesc: 'Change ID photo background color',
                faq_free_q: 'Is this tool really free with no ads?',
                faq_free_a: 'Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser â€” your data is never uploaded to any server.',
                trust_users: 'ğŸŒ Used by 50,000+ users',
                trust_rating: 'â­ 4.9/5 rating',
                trust_privacy: 'ğŸ”’ 100% Private',
                trust_free: 'ğŸš« No Ads, No Signup'
            },
            'zh-CN': {
                langName: 'ğŸŒ ä¸­æ–‡',
                backLink: 'â† è¿”å›å·¥å…·ç®±',
                title: 'ğŸ¨ ICO å›¾æ ‡åˆ¶ä½œ',
                subtitle: 'å°† PNGã€JPGã€GIF å›¾ç‰‡è½¬æ¢ä¸º ICO å›¾æ ‡æ–‡ä»¶',
                feature1Title: '100% å…è´¹ä¸”å®‰å…¨',
                feature1Desc: 'æ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œã€æ— æ°´å°ã€‚æ‰€æœ‰å¤„ç†éƒ½åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œæ•°æ®ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨ã€‚',
                feature2Title: 'æ ¼å¼è½¬æ¢',
                feature2Desc: 'æ”¯æŒ PNGã€JPGã€GIFã€WebP ç­‰æ ¼å¼è½¬æ¢ä¸º ICO',
                feature3Title: 'å®æ—¶é¢„è§ˆ',
                feature3Desc: 'ä¸Šä¼ åå³æ—¶é¢„è§ˆå„å°ºå¯¸çš„å›¾æ ‡æ•ˆæœ',
                feature4Title: 'æ‰¹é‡æ‰“åŒ…',
                feature4Desc: 'å¤šä¸ªå°ºå¯¸æ‰“åŒ…æˆä¸€ä¸ª ICO æ–‡ä»¶',
                step1: 'é€‰æ‹©å›¾ç‰‡',
                step2: 'è£å‰ªè°ƒæ•´',
                step3: 'é€‰æ‹©å°ºå¯¸',
                step4: 'ç”Ÿæˆä¸‹è½½',
                uploadTitle: 'ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°è¿™é‡Œ',
                uploadHint: 'æ”¯æŒ PNGã€JPGã€GIF æ ¼å¼',
                selectImage: 'é€‰æ‹©å›¾ç‰‡',
                cropTitle: 'è£å‰ªå›¾ç‰‡ï¼ˆæ‹–åŠ¨è°ƒæ•´æ­£æ–¹å½¢åŒºåŸŸï¼‰',
                cropArea: 'è£å‰ªåŒºåŸŸ: {width} Ã— {height} px',
                reset: 'é‡ç½®',
                skipCrop: 'è·³è¿‡è£å‰ª',
                confirmCrop: 'ç¡®è®¤è£å‰ª',
                previewTitle: 'æœ€ç»ˆå›¾ç‰‡é¢„è§ˆ',
                sizeTitle: 'é€‰æ‹© ICO å›¾æ ‡å°ºå¯¸',
                sizeTip: 'ğŸ’¡ æç¤ºï¼šå¯ä»¥åŒæ—¶é€‰æ‹©å¤šä¸ªå°ºå¯¸ï¼Œç”Ÿæˆçš„ ICO æ–‡ä»¶å°†åŒ…å«æ‰€æœ‰é€‰ä¸­çš„å°ºå¯¸ã€‚',
                generateBtn: 'ç”Ÿæˆ ICO å›¾æ ‡',
                resultTitle: 'ICO å›¾æ ‡ç”ŸæˆæˆåŠŸï¼',
                downloadBtn: 'ä¸‹è½½ ICO æ–‡ä»¶',
                footerPrivacy: 'çº¯å‰ç«¯å¤„ç†ï¼Œå›¾ç‰‡ä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨',
                footerBack: 'â† è¿”å› Web Toolbox',
                imageSelected: 'âœ“ å›¾ç‰‡å·²é€‰æ‹©',
                reselect: 'é‡æ–°é€‰æ‹©',
                generating: 'ç”Ÿæˆä¸­...',
                sizeInfo: 'å°ºå¯¸: {width} Ã— {height} pxï¼ˆæ­£æ–¹å½¢ï¼‰',
                resultInfo: 'åŒ…å« {count} ä¸ªå°ºå¯¸ ({sizes}) | æ–‡ä»¶å¤§å°: {fileSize} KB',
                alertSelectImage: 'è¯·å…ˆé€‰æ‹©å¹¶è£å‰ªå›¾ç‰‡ï¼',
                alertSelectSize: 'è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªå°ºå¯¸ï¼',
                alertInvalidFormat: 'è¯·é€‰æ‹© PNGã€JPG æˆ– GIF æ ¼å¼çš„å›¾ç‰‡ï¼',
                alertGenerateFailed: 'ç”Ÿæˆ ICO å¤±è´¥ï¼Œè¯·é‡è¯•ï¼',
                faqTitle: 'â“ å¸¸è§é—®é¢˜',
                faq1Q: 'ICO æ ¼å¼æœ‰ä»€ä¹ˆç”¨ï¼Ÿ',
                faq1A: 'ICO æ˜¯ Windows å›¾æ ‡æ ¼å¼ï¼Œç”¨äºæ¡Œé¢å¿«æ·æ–¹å¼ã€ç½‘ç«™ favicon ç­‰ã€‚å®ƒå¯ä»¥åŒ…å«å¤šä¸ªå°ºå¯¸çš„å›¾æ ‡ï¼Œç³»ç»Ÿä¼šæ ¹æ®éœ€è¦è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å°ºå¯¸æ˜¾ç¤ºã€‚',
                faq2Q: 'æ¨èä½¿ç”¨ä»€ä¹ˆå°ºå¯¸çš„å›¾ç‰‡ï¼Ÿ',
                faq2A: 'å»ºè®®ä½¿ç”¨ 256x256 æˆ–æ›´å¤§çš„æ­£æ–¹å½¢å›¾ç‰‡ï¼Œå·¥å…·ä¼šè‡ªåŠ¨ç¼©æ”¾ç”Ÿæˆå„ç§æ‰€éœ€å°ºå¯¸ã€‚ä½¿ç”¨é«˜åˆ†è¾¨ç‡åŸå›¾å¯ä»¥ä¿è¯ç¼©æ”¾åçš„å›¾æ ‡è´¨é‡ã€‚',
                faq3Q: 'æ”¯æŒé€æ˜èƒŒæ™¯å—ï¼Ÿ',
                faq3A: 'æ”¯æŒï¼Œä¸Šä¼  PNG æ ¼å¼çš„é€æ˜å›¾ç‰‡å³å¯ä¿ç•™é€æ˜åº¦ã€‚ç”Ÿæˆçš„ ICO æ–‡ä»¶ä¼šä¿æŒåŸå›¾çš„é€æ˜é€šé“ã€‚',
                faq4Q: 'ç”Ÿæˆçš„ ICO åŒ…å«å“ªäº›å°ºå¯¸ï¼Ÿ',
                faq4A: 'åŒ…å« 16x16ã€32x32ã€48x48ã€64x64ã€128x128ã€256x256 ç­‰å¸¸ç”¨å°ºå¯¸ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦è‡ªç”±é€‰æ‹©è¦åŒ…å«çš„å°ºå¯¸ã€‚',
                faq5Q: 'å¯ä»¥ç”¨äºç½‘ç«™ favicon å—ï¼Ÿ',
                faq5A: 'å¯ä»¥ï¼Œç”Ÿæˆçš„ ICO æ–‡ä»¶å¯ç›´æ¥ç”¨ä½œç½‘ç«™å›¾æ ‡ã€‚å°†æ–‡ä»¶å‘½åä¸º favicon.ico å¹¶æ”¾ç½®åœ¨ç½‘ç«™æ ¹ç›®å½•å³å¯è¢«æµè§ˆå™¨è‡ªåŠ¨è¯†åˆ«ã€‚',
                relatedTools: 'ğŸ”— ç›¸å…³å·¥å…·æ¨è',
                imageCompressor: 'å›¾ç‰‡å‹ç¼©',
                imageCompressorDesc: 'åœ¨çº¿å‹ç¼©å›¾ç‰‡å¤§å°',
                imageConverter: 'å›¾ç‰‡æ ¼å¼è½¬æ¢',
                imageConverterDesc: 'PNG/JPG/WebP äº’è½¬',
                imageEditor: 'å›¾ç‰‡ç¼–è¾‘å™¨',
                imageEditorDesc: 'è£å‰ªã€æ—‹è½¬ã€æ»¤é•œ',
                idPhotoTool: 'è¯ä»¶ç…§åˆ¶ä½œ',
                idPhotoToolDesc: 'è¯ä»¶ç…§æ¢åº•è‰²',
                faq_free_q: 'è¿™ä¸ªå·¥å…·çœŸçš„å®Œå…¨å…è´¹æ— å¹¿å‘Šå—ï¼Ÿ',
                faq_free_a: 'æ˜¯çš„ï¼Œ100% å…è´¹ï¼Œæ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œã€æ— æ°´å°ã€æ— ä½¿ç”¨é™åˆ¶ã€‚æ‰€æœ‰å¤„ç†éƒ½åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆã€‚',
                trust_users: 'ğŸŒ è¶…è¿‡ 50,000 ç”¨æˆ·ä½¿ç”¨',
                trust_rating: 'â­ 4.9/5 å¥½è¯„',
                trust_privacy: 'ğŸ”’ 100% éšç§å®‰å…¨',
                trust_free: 'ğŸš« æ— å¹¿å‘Šã€æ— éœ€æ³¨å†Œ'
            },
            'fr': {
                langName: 'ğŸŒ FranÃ§ais',
                backLink: 'â† Retour Ã  la boÃ®te Ã  outils',
                title: 'ğŸ¨ CrÃ©ateur d\'icÃ´nes ICO',
                subtitle: 'Convertir des images PNG, JPG, GIF en fichiers icÃ´nes ICO',
                feature1Title: '100% Gratuit et PrivÃ©',
                feature1Desc: 'Sans publicitÃ©, sans inscription, sans filigrane. Tout est traitÃ© localement dans votre navigateur.',
                feature2Title: 'Conversion de format',
                feature2Desc: 'Prend en charge la conversion des formats PNG, JPG, GIF, WebP vers ICO',
                feature3Title: 'AperÃ§u en temps rÃ©el',
                feature3Desc: 'AperÃ§u instantanÃ© des effets d\'icÃ´nes dans diffÃ©rentes tailles aprÃ¨s tÃ©lÃ©chargement',
                feature4Title: 'Empaquetage par lots',
                feature4Desc: 'Regrouper plusieurs tailles dans un seul fichier ICO',
                step1: 'SÃ©lectionner l\'image',
                step2: 'Recadrer et ajuster',
                step3: 'SÃ©lectionner les tailles',
                step4: 'GÃ©nÃ©rer et tÃ©lÃ©charger',
                uploadTitle: 'Cliquez ou dÃ©posez l\'image ici',
                uploadHint: 'Prend en charge les formats PNG, JPG, GIF',
                selectImage: 'SÃ©lectionner l\'image',
                cropTitle: 'Recadrer l\'image (Glisser pour ajuster la zone carrÃ©e)',
                cropArea: 'Zone de recadrage: {width} Ã— {height} px',
                reset: 'RÃ©initialiser',
                skipCrop: 'Ignorer le recadrage',
                confirmCrop: 'Confirmer le recadrage',
                previewTitle: 'AperÃ§u de l\'image finale',
                sizeTitle: 'SÃ©lectionner les tailles d\'icÃ´nes ICO',
                sizeTip: 'ğŸ’¡ Astuce: Vous pouvez sÃ©lectionner plusieurs tailles, et le fichier ICO gÃ©nÃ©rÃ© contiendra toutes les tailles sÃ©lectionnÃ©es.',
                generateBtn: 'GÃ©nÃ©rer l\'icÃ´ne ICO',
                resultTitle: 'IcÃ´ne ICO gÃ©nÃ©rÃ©e avec succÃ¨s !',
                downloadBtn: 'TÃ©lÃ©charger le fichier ICO',
                footerPrivacy: 'Traitement purement frontend, les images ne sont pas tÃ©lÃ©chargÃ©es sur le serveur',
                footerBack: 'â† Retour Ã  Web Toolbox',
                imageSelected: 'âœ“ Image sÃ©lectionnÃ©e',
                reselect: 'ResÃ©lectionner',
                generating: 'GÃ©nÃ©ration en cours...',
                sizeInfo: 'Taille: {width} Ã— {height} px (CarrÃ©)',
                resultInfo: 'Contient {count} tailles ({sizes}) | Taille du fichier: {fileSize} Ko',
                alertSelectImage: 'Veuillez d\'abord sÃ©lectionner et recadrer une image !',
                alertSelectSize: 'Veuillez sÃ©lectionner au moins une taille !',
                alertInvalidFormat: 'Veuillez sÃ©lectionner une image au format PNG, JPG ou GIF !',
                alertGenerateFailed: 'Ã‰chec de la gÃ©nÃ©ration ICO, veuillez rÃ©essayer !',
                faqTitle: 'â“ FAQ',
                faq1Q: 'Ã€ quoi sert le format ICO ?',
                faq1A: 'ICO est le format d\'icÃ´ne Windows, utilisÃ© pour les raccourcis de bureau, les favicons de sites web, etc. Il peut contenir plusieurs tailles d\'icÃ´nes, et le systÃ¨me choisira automatiquement la taille appropriÃ©e Ã  afficher.',
                faq2Q: 'Quelle taille d\'image est recommandÃ©e ?',
                faq2A: 'Nous recommandons d\'utiliser des images carrÃ©es de 256x256 ou plus. L\'outil redimensionnera automatiquement pour gÃ©nÃ©rer les diffÃ©rentes tailles requises. L\'utilisation d\'images sources haute rÃ©solution garantit la qualitÃ© aprÃ¨s mise Ã  l\'Ã©chelle.',
                faq3Q: 'Prend-il en charge les arriÃ¨re-plans transparents ?',
                faq3A: 'Oui, tÃ©lÃ©chargez une image PNG avec transparence pour conserver les zones transparentes. Le fichier ICO gÃ©nÃ©rÃ© maintiendra le canal alpha de l\'image originale.',
                faq4Q: 'Quelles tailles sont incluses dans l\'ICO gÃ©nÃ©rÃ© ?',
                faq4A: 'Il comprend des tailles courantes comme 16x16, 32x32, 48x48, 64x64, 128x128, 256x256, etc. Vous pouvez librement sÃ©lectionner les tailles Ã  inclure.',
                faq5Q: 'Peut-il Ãªtre utilisÃ© comme favicon de site web ?',
                faq5A: 'Oui, le fichier ICO gÃ©nÃ©rÃ© peut Ãªtre utilisÃ© directement comme icÃ´ne de site web. Nommez le fichier favicon.ico et placez-le dans le rÃ©pertoire racine du site web pour que les navigateurs le reconnaissent automatiquement.',
                relatedTools: 'ğŸ”— Outils connexes',
                imageCompressor: 'Compresseur d\'images',
                imageCompressorDesc: 'Compresser la taille des images en ligne',
                imageConverter: 'Convertisseur de format d\'image',
                imageConverterDesc: 'Convertir entre PNG/JPG/WebP',
                imageEditor: 'Ã‰diteur d\'images',
                imageEditorDesc: 'Recadrer, pivoter, filtres',
                idPhotoTool: 'CrÃ©ateur de photo d\'identitÃ©',
                idPhotoToolDesc: 'Changer la couleur de fond de la photo d\'identitÃ©',
                faq_free_q: 'Cet outil est-il vraiment gratuit sans publicitÃ© ?',
                faq_free_a: 'Oui, 100% gratuit sans publicitÃ©, sans inscription, sans filigrane et sans limite d\'utilisation.',
                trust_users: 'ğŸŒ UtilisÃ© par 50 000+ utilisateurs',
                trust_rating: 'â­ Note 4.9/5',
                trust_privacy: 'ğŸ”’ 100% PrivÃ©',
                trust_free: 'ğŸš« Sans pub, sans inscription'
            },
            'es': {
                langName: 'ğŸŒ EspaÃ±ol',
                backLink: 'â† Volver a la caja de herramientas',
                title: 'ğŸ¨ Creador de iconos ICO',
                subtitle: 'Convertir imÃ¡genes PNG, JPG, GIF a archivos de iconos ICO',
                feature1Title: '100% Gratis y Privado',
                feature1Desc: 'Sin anuncios, sin registro, sin marca de agua. Todo se procesa localmente en tu navegador.',
                feature2Title: 'ConversiÃ³n de formato',
                feature2Desc: 'Soporta conversiÃ³n de formatos PNG, JPG, GIF, WebP a ICO',
                feature3Title: 'Vista previa en tiempo real',
                feature3Desc: 'Vista previa instantÃ¡nea de efectos de iconos en varios tamaÃ±os despuÃ©s de subir',
                feature4Title: 'Empaquetado por lotes',
                feature4Desc: 'Empaqueta mÃºltiples tamaÃ±os en un solo archivo ICO',
                step1: 'Seleccionar imagen',
                step2: 'Recortar y ajustar',
                step3: 'Seleccionar tamaÃ±os',
                step4: 'Generar y descargar',
                uploadTitle: 'Haz clic o arrastra la imagen aquÃ­',
                uploadHint: 'Soporta formatos PNG, JPG, GIF',
                selectImage: 'Seleccionar imagen',
                cropTitle: 'Recortar imagen (Arrastra para ajustar el Ã¡rea cuadrada)',
                cropArea: 'Ãrea de recorte: {width} Ã— {height} px',
                reset: 'Restablecer',
                skipCrop: 'Omitir recorte',
                confirmCrop: 'Confirmar recorte',
                previewTitle: 'Vista previa de la imagen final',
                sizeTitle: 'Seleccionar tamaÃ±os de iconos ICO',
                sizeTip: 'ğŸ’¡ Consejo: Puedes seleccionar mÃºltiples tamaÃ±os, y el archivo ICO generado contendrÃ¡ todos los tamaÃ±os seleccionados.',
                generateBtn: 'Generar icono ICO',
                resultTitle: 'Â¡Icono ICO generado con Ã©xito!',
                downloadBtn: 'Descargar archivo ICO',
                footerPrivacy: 'Procesamiento puro de frontend, las imÃ¡genes no se suben al servidor',
                footerBack: 'â† Volver a Web Toolbox',
                imageSelected: 'âœ“ Imagen seleccionada',
                reselect: 'Reseleccionar',
                generating: 'Generando...',
                sizeInfo: 'TamaÃ±o: {width} Ã— {height} px (Cuadrado)',
                resultInfo: 'Contiene {count} tamaÃ±os ({sizes}) | TamaÃ±o del archivo: {fileSize} KB',
                alertSelectImage: 'Â¡Por favor, primero selecciona y recorta una imagen!',
                alertSelectSize: 'Â¡Por favor, selecciona al menos un tamaÃ±o!',
                alertInvalidFormat: 'Â¡Por favor, selecciona una imagen en formato PNG, JPG o GIF!',
                alertGenerateFailed: 'Â¡Error al generar ICO, por favor intenta de nuevo!',
                faqTitle: 'â“ Preguntas frecuentes',
                faq1Q: 'Â¿Para quÃ© se usa el formato ICO?',
                faq1A: 'ICO es el formato de icono de Windows, utilizado para accesos directos de escritorio, favicons de sitios web, etc. Puede contener mÃºltiples tamaÃ±os de iconos, y el sistema elegirÃ¡ automÃ¡ticamente el tamaÃ±o apropiado para mostrar.',
                faq2Q: 'Â¿QuÃ© tamaÃ±o de imagen se recomienda?',
                faq2A: 'Recomendamos usar imÃ¡genes cuadradas de 256x256 o mÃ¡s grandes. La herramienta escalarÃ¡ automÃ¡ticamente para generar los diversos tamaÃ±os requeridos. Usar imÃ¡genes fuente de alta resoluciÃ³n asegura la calidad despuÃ©s del escalado.',
                faq3Q: 'Â¿Soporta fondos transparentes?',
                faq3A: 'SÃ­, sube una imagen PNG con transparencia para preservar las Ã¡reas transparentes. El archivo ICO generado mantendrÃ¡ el canal alfa de la imagen original.',
                faq4Q: 'Â¿QuÃ© tamaÃ±os incluye el ICO generado?',
                faq4A: 'Incluye tamaÃ±os comunes como 16x16, 32x32, 48x48, 64x64, 128x128, 256x256, etc. Puedes seleccionar libremente quÃ© tamaÃ±os incluir.',
                faq5Q: 'Â¿Se puede usar como favicon del sitio web?',
                faq5A: 'SÃ­, el archivo ICO generado se puede usar directamente como icono del sitio web. Nombra el archivo favicon.ico y colÃ³calo en el directorio raÃ­z del sitio web para que los navegadores lo reconozcan automÃ¡ticamente.',
                relatedTools: 'ğŸ”— Herramientas relacionadas',
                imageCompressor: 'Compresor de imÃ¡genes',
                imageCompressorDesc: 'Comprimir tamaÃ±o de imagen en lÃ­nea',
                imageConverter: 'Convertidor de formato de imagen',
                imageConverterDesc: 'Convertir entre PNG/JPG/WebP',
                imageEditor: 'Editor de imÃ¡genes',
                imageEditorDesc: 'Recortar, rotar, filtros',
                idPhotoTool: 'Creador de foto de ID',
                idPhotoToolDesc: 'Cambiar color de fondo de foto de ID',
                faq_free_q: 'Â¿Esta herramienta es realmente gratuita sin anuncios?',
                faq_free_a: 'SÃ­, 100% gratuita sin anuncios, sin registro, sin marca de agua y sin lÃ­mites de uso.',
                trust_users: 'ğŸŒ Usado por mÃ¡s de 50,000 usuarios',
                trust_rating: 'â­ CalificaciÃ³n 4.9/5',
                trust_privacy: 'ğŸ”’ 100% Privado',
                trust_free: 'ğŸš« Sin anuncios, sin registro'
            }
        };

        let currentLang = localStorage.getItem('preferred-lang') || 'en';

        function t(key, params = {}) {
            let text = i18n[currentLang]?.[key] || i18n['en'][key] || key;
            Object.keys(params).forEach(param => {
                text = text.replace(`{${param}}`, params[param]);
            });
            return text;
        }

        function updatePageLanguage() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (i18n[currentLang]?.[key]) {
                    el.textContent = i18n[currentLang][key];
                }
            });
            document.getElementById('langCurrent').textContent = i18n[currentLang]?.langName || 'ğŸŒ English';

            // æ›´æ–° FAQ åŒºå—
            updateFaqSection();
            // æ›´æ–°ç›¸å…³å·¥å…·åŒºå—
            updateRelatedToolsSection();
        }

        function updateFaqSection() {
            const faqSection = document.querySelector('.faq-section');
            if (faqSection) {
                faqSection.innerHTML = `
                    <h2 class="faq-title"><span>${t('faqTitle')}</span></h2>
                    <div class="faq-list">
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                <span>${t('faq1Q')}</span>
                            </div>
                            <div class="faq-answer">
                                <div class="faq-answer-content">${t('faq1A')}</div>
                            </div>
                        </div>
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                <span>${t('faq2Q')}</span>
                            </div>
                            <div class="faq-answer">
                                <div class="faq-answer-content">${t('faq2A')}</div>
                            </div>
                        </div>
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                <span>${t('faq3Q')}</span>
                            </div>
                            <div class="faq-answer">
                                <div class="faq-answer-content">${t('faq3A')}</div>
                            </div>
                        </div>
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                <span>${t('faq4Q')}</span>
                            </div>
                            <div class="faq-answer">
                                <div class="faq-answer-content">${t('faq4A')}</div>
                            </div>
                        </div>
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFaq(this)">
                                <span>${t('faq5Q')}</span>
                            </div>
                            <div class="faq-answer">
                                <div class="faq-answer-content">${t('faq5A')}</div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        function updateRelatedToolsSection() {
            const relatedSection = document.querySelector('.related-tools');
            if (relatedSection) {
                relatedSection.innerHTML = `
                    <h3 style="color: #e6edf3; font-size: 18px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #30363d;">${t('relatedTools')}</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                        <a href="image-compressor.html" style="display: block; padding: 16px; background: #161b22; border: 1px solid #30363d; border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                            <div style="font-size: 24px; margin-bottom: 8px;">ğŸ—œï¸</div>
                            <div style="color: #e6edf3; font-weight: 500;">${t('imageCompressor')}</div>
                            <div style="color: #8b949e; font-size: 12px; margin-top: 4px;">${t('imageCompressorDesc')}</div>
                        </a>
                        <a href="image-converter.html" style="display: block; padding: 16px; background: #161b22; border: 1px solid #30363d; border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                            <div style="font-size: 24px; margin-bottom: 8px;">ğŸ”„</div>
                            <div style="color: #e6edf3; font-weight: 500;">${t('imageConverter')}</div>
                            <div style="color: #8b949e; font-size: 12px; margin-top: 4px;">${t('imageConverterDesc')}</div>
                        </a>
                        <a href="image-editor.html" style="display: block; padding: 16px; background: #161b22; border: 1px solid #30363d; border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                            <div style="font-size: 24px; margin-bottom: 8px;">âœï¸</div>
                            <div style="color: #e6edf3; font-weight: 500;">${t('imageEditor')}</div>
                            <div style="color: #8b949e; font-size: 12px; margin-top: 4px;">${t('imageEditorDesc')}</div>
                        </a>
                        <a href="id-photo-tool.html" style="display: block; padding: 16px; background: #161b22; border: 1px solid #30363d; border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                            <div style="font-size: 24px; margin-bottom: 8px;">ğŸ“·</div>
                            <div style="color: #e6edf3; font-weight: 500;">${t('idPhotoTool')}</div>
                            <div style="color: #8b949e; font-size: 12px; margin-top: 4px;">${t('idPhotoToolDesc')}</div>
                        </a>
                    </div>
                `;
            }
        }

        function switchLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('preferred-lang', lang);
            updatePageLanguage();
            document.getElementById('langDropdown').classList.remove('active');
        }

        // è¯­è¨€åˆ‡æ¢å™¨äº‹ä»¶
        document.getElementById('langCurrent').addEventListener('click', (e) => {
            e.stopPropagation();
            document.getElementById('langDropdown').classList.toggle('active');
        });

        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                switchLanguage(btn.dataset.lang);
            });
        });

        document.addEventListener('click', () => {
            document.getElementById('langDropdown').classList.remove('active');
        });

        // é¡µé¢åŠ è½½æ—¶åº”ç”¨è¯­è¨€
        document.addEventListener('DOMContentLoaded', () => {
            updatePageLanguage();
        });

        // ==================== åŸæœ‰åŠŸèƒ½ä»£ç  ====================
        let originalImage = null;
        let croppedImage = null;
        let fileName = 'favicon';

        // è£å‰ªç›¸å…³å˜é‡
        let cropBox, cropImage, cropContainer;
        let isDragging = false;
        let isResizing = false;
        let currentHandle = null;
        let startX, startY, startLeft, startTop, startWidth, startHeight;
        let imageScale = 1;

        // æ‹–æ‹½ä¸Šä¼ 
        const uploadArea = document.getElementById('uploadArea');

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            if (!file.type.match(/^image\/(png|jpeg|gif)$/)) {
                alert(t('alertInvalidFormat'));
                return;
            }

            fileName = file.name.replace(/\.[^/.]+$/, '') || 'favicon';

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    originalImage = img;
                    croppedImage = null;
                    showCropArea(img, file);
                    updateSteps(2);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function showCropArea(img, file) {
            // æ›´æ–°ä¸Šä¼ åŒºåŸŸ
            uploadArea.classList.add('has-image');
            uploadArea.innerHTML = `
                <div style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap; justify-content: center;">
                    <img src="${img.src}" style="max-height: 60px; border-radius: 8px;">
                    <div style="text-align: left;">
                        <div style="color: #22c55e; font-weight: 500; margin-bottom: 4px;">${t('imageSelected')}</div>
                        <div style="color: #71717a; font-size: 0.9rem;">${file.name} (${img.width}Ã—${img.height})</div>
                    </div>
                    <button class="upload-btn" onclick="event.stopPropagation(); document.getElementById('fileInput').click()">
                        <span>ğŸ”„</span>
                        <span>${t('reselect')}</span>
                    </button>
                </div>
                <input type="file" id="fileInput" accept="image/png,image/jpeg,image/gif" onchange="handleFileSelect(event)" style="display:none;">
            `;

            // æ˜¾ç¤ºè£å‰ªåŒºåŸŸ
            cropImage = document.getElementById('cropImage');
            cropBox = document.getElementById('cropBox');
            cropContainer = document.getElementById('cropContainer');

            cropImage.src = img.src;
            cropImage.onload = () => {
                initCropBox();
            };

            document.getElementById('cropSection').classList.add('show');
            document.getElementById('previewSection').classList.remove('show');
            document.getElementById('generateBtn').disabled = true;
        }

        function initCropBox() {
            const rect = cropImage.getBoundingClientRect();
            const containerRect = cropContainer.getBoundingClientRect();

            // è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
            imageScale = originalImage.width / cropImage.offsetWidth;

            // åˆå§‹åŒ–æ­£æ–¹å½¢è£å‰ªæ¡†ï¼ˆå±…ä¸­ï¼Œå¤§å°ä¸ºè¾ƒå°è¾¹çš„80%ï¼‰
            const minSide = Math.min(cropImage.offsetWidth, cropImage.offsetHeight);
            const boxSize = Math.floor(minSide * 0.8);

            const left = (cropImage.offsetWidth - boxSize) / 2;
            const top = (cropImage.offsetHeight - boxSize) / 2;

            cropBox.style.left = left + 'px';
            cropBox.style.top = top + 'px';
            cropBox.style.width = boxSize + 'px';
            cropBox.style.height = boxSize + 'px';

            updateCropInfo();
            setupCropEvents();
        }

        function setupCropEvents() {
            // ç§»åŠ¨è£å‰ªæ¡†
            cropBox.addEventListener('mousedown', (e) => {
                if (e.target.classList.contains('crop-handle')) return;
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                startLeft = cropBox.offsetLeft;
                startTop = cropBox.offsetTop;
                e.preventDefault();
            });

            // è°ƒæ•´å¤§å°æ‰‹æŸ„
            document.querySelectorAll('.crop-handle').forEach(handle => {
                handle.addEventListener('mousedown', (e) => {
                    isResizing = true;
                    currentHandle = e.target.dataset.handle;
                    startX = e.clientX;
                    startY = e.clientY;
                    startLeft = cropBox.offsetLeft;
                    startTop = cropBox.offsetTop;
                    startWidth = cropBox.offsetWidth;
                    startHeight = cropBox.offsetHeight;
                    e.preventDefault();
                    e.stopPropagation();
                });
            });

            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', () => {
                isDragging = false;
                isResizing = false;
                currentHandle = null;
            });

            // è§¦æ‘¸äº‹ä»¶æ”¯æŒ
            cropBox.addEventListener('touchstart', (e) => {
                if (e.target.classList.contains('crop-handle')) return;
                isDragging = true;
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                startLeft = cropBox.offsetLeft;
                startTop = cropBox.offsetTop;
                e.preventDefault();
            });

            document.querySelectorAll('.crop-handle').forEach(handle => {
                handle.addEventListener('touchstart', (e) => {
                    isResizing = true;
                    currentHandle = e.target.dataset.handle;
                    startX = e.touches[0].clientX;
                    startY = e.touches[0].clientY;
                    startLeft = cropBox.offsetLeft;
                    startTop = cropBox.offsetTop;
                    startWidth = cropBox.offsetWidth;
                    startHeight = cropBox.offsetHeight;
                    e.preventDefault();
                    e.stopPropagation();
                });
            });

            document.addEventListener('touchmove', (e) => {
                if (e.touches.length > 0) {
                    handleMouseMove({ clientX: e.touches[0].clientX, clientY: e.touches[0].clientY });
                }
            });

            document.addEventListener('touchend', () => {
                isDragging = false;
                isResizing = false;
                currentHandle = null;
            });
        }

        function handleMouseMove(e) {
            if (!isDragging && !isResizing) return;

            const dx = e.clientX - startX;
            const dy = e.clientY - startY;
            const imgWidth = cropImage.offsetWidth;
            const imgHeight = cropImage.offsetHeight;

            if (isDragging) {
                let newLeft = startLeft + dx;
                let newTop = startTop + dy;

                // è¾¹ç•Œé™åˆ¶
                newLeft = Math.max(0, Math.min(newLeft, imgWidth - cropBox.offsetWidth));
                newTop = Math.max(0, Math.min(newTop, imgHeight - cropBox.offsetHeight));

                cropBox.style.left = newLeft + 'px';
                cropBox.style.top = newTop + 'px';
            }

            if (isResizing) {
                let newWidth, newHeight, newLeft, newTop;
                const delta = Math.max(Math.abs(dx), Math.abs(dy));
                const sign = (dx + dy) > 0 ? 1 : -1;

                switch (currentHandle) {
                    case 'se':
                        newWidth = Math.max(50, startWidth + delta * sign);
                        newHeight = newWidth;
                        newLeft = startLeft;
                        newTop = startTop;
                        break;
                    case 'sw':
                        newWidth = Math.max(50, startWidth - delta * sign);
                        newHeight = newWidth;
                        newLeft = startLeft + startWidth - newWidth;
                        newTop = startTop;
                        break;
                    case 'ne':
                        newWidth = Math.max(50, startWidth + delta * sign);
                        newHeight = newWidth;
                        newLeft = startLeft;
                        newTop = startTop + startHeight - newHeight;
                        break;
                    case 'nw':
                        newWidth = Math.max(50, startWidth - delta * sign);
                        newHeight = newWidth;
                        newLeft = startLeft + startWidth - newWidth;
                        newTop = startTop + startHeight - newHeight;
                        break;
                }

                // è¾¹ç•Œé™åˆ¶
                if (newLeft < 0) {
                    newWidth += newLeft;
                    newLeft = 0;
                }
                if (newTop < 0) {
                    newHeight += newTop;
                    newTop = 0;
                }
                if (newLeft + newWidth > imgWidth) {
                    newWidth = imgWidth - newLeft;
                }
                if (newTop + newHeight > imgHeight) {
                    newHeight = imgHeight - newTop;
                }

                // ä¿æŒæ­£æ–¹å½¢
                const minSize = Math.min(newWidth, newHeight);
                newWidth = newHeight = minSize;

                cropBox.style.left = newLeft + 'px';
                cropBox.style.top = newTop + 'px';
                cropBox.style.width = newWidth + 'px';
                cropBox.style.height = newHeight + 'px';
            }

            updateCropInfo();
        }

        function updateCropInfo() {
            const realWidth = Math.round(cropBox.offsetWidth * imageScale);
            const realHeight = Math.round(cropBox.offsetHeight * imageScale);
            document.getElementById('cropSizeInfo').textContent = t('cropArea', { width: realWidth, height: realHeight });
        }

        function resetCrop() {
            initCropBox();
        }

        function skipCrop() {
            // ä½¿ç”¨åŸå›¾ï¼Œè‡ªåŠ¨è£å‰ªä¸ºæ­£æ–¹å½¢ï¼ˆå±…ä¸­ï¼‰
            const canvas = document.createElement('canvas');
            const size = Math.min(originalImage.width, originalImage.height);
            canvas.width = size;
            canvas.height = size;
            const ctx = canvas.getContext('2d');

            const sx = (originalImage.width - size) / 2;
            const sy = (originalImage.height - size) / 2;
            ctx.drawImage(originalImage, sx, sy, size, size, 0, 0, size, size);

            const croppedDataUrl = canvas.toDataURL('image/png');
            const img = new Image();
            img.onload = () => {
                croppedImage = img;
                showFinalPreview(img);
            };
            img.src = croppedDataUrl;
        }

        function applyCrop() {
            // è·å–è£å‰ªåŒºåŸŸ
            const left = cropBox.offsetLeft * imageScale;
            const top = cropBox.offsetTop * imageScale;
            const width = cropBox.offsetWidth * imageScale;
            const height = cropBox.offsetHeight * imageScale;

            // åˆ›å»ºè£å‰ªåçš„å›¾ç‰‡
            const canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(originalImage, left, top, width, height, 0, 0, width, height);

            const croppedDataUrl = canvas.toDataURL('image/png');
            const img = new Image();
            img.onload = () => {
                croppedImage = img;
                showFinalPreview(img);
            };
            img.src = croppedDataUrl;
        }

        function showFinalPreview(img) {
            document.getElementById('previewImage').src = img.src;
            document.getElementById('imageInfo').textContent = t('sizeInfo', { width: img.width, height: img.height });

            document.getElementById('cropSection').classList.remove('show');
            document.getElementById('previewSection').classList.add('show');
            document.getElementById('generateBtn').disabled = false;

            updateSteps(3);
        }

        function updateSteps(currentStep) {
            for (let i = 1; i <= 4; i++) {
                const step = document.getElementById(`step${i}`);
                step.classList.remove('active', 'completed');
                if (i < currentStep) {
                    step.classList.add('completed');
                } else if (i === currentStep) {
                    step.classList.add('active');
                }
            }
        }

        function getSelectedSizes() {
            const checkboxes = document.querySelectorAll('input[name="size"]:checked');
            return Array.from(checkboxes).map(cb => parseInt(cb.value)).sort((a, b) => a - b);
        }

        async function generateICO() {
            const imageToUse = croppedImage || originalImage;
            if (!imageToUse) {
                alert(t('alertSelectImage'));
                return;
            }

            const sizes = getSelectedSizes();
            if (sizes.length === 0) {
                alert(t('alertSelectSize'));
                return;
            }

            const btn = document.getElementById('generateBtn');
            btn.disabled = true;
            btn.innerHTML = `<span>â³</span><span>${t('generating')}</span>`;

            try {
                const images = [];
                const previewGrid = document.getElementById('icoPreviewGrid');
                previewGrid.innerHTML = '';

                for (const size of sizes) {
                    const canvas = document.createElement('canvas');
                    canvas.width = size;
                    canvas.height = size;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(imageToUse, 0, 0, size, size);

                    const dataUrl = canvas.toDataURL('image/png');
                    const pngData = await dataURLToUint8Array(dataUrl);
                    images.push({ size, data: pngData });

                    const previewItem = document.createElement('div');
                    previewItem.className = 'ico-preview-item';
                    const displaySize = Math.min(size, 80);
                    previewItem.innerHTML = `
                        <div class="ico-preview-box" style="width: ${displaySize + 20}px; height: ${displaySize + 20}px;">
                            <img src="${dataUrl}" style="width: ${displaySize}px; height: ${displaySize}px;">
                        </div>
                        <div class="ico-size-label">${size}Ã—${size}</div>
                    `;
                    previewGrid.appendChild(previewItem);
                }

                const icoData = createICO(images);
                const blob = new Blob([icoData], { type: 'image/x-icon' });
                const url = URL.createObjectURL(blob);

                const downloadBtn = document.getElementById('downloadBtn');
                downloadBtn.href = url;
                downloadBtn.download = `${fileName}.ico`;

                const totalSize = (blob.size / 1024).toFixed(1);
                document.getElementById('resultInfo').innerHTML = t('resultInfo', {
                    count: sizes.length,
                    sizes: sizes.join(', '),
                    fileSize: totalSize
                });

                document.getElementById('resultSection').classList.add('show');
                updateSteps(4);

                document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                console.error('Generate failed:', error);
                alert(t('alertGenerateFailed'));
            }

            btn.disabled = false;
            btn.innerHTML = `<span>âœ¨</span><span>${t('generateBtn')}</span>`;
        }

        async function dataURLToUint8Array(dataUrl) {
            const response = await fetch(dataUrl);
            const blob = await response.blob();
            const arrayBuffer = await blob.arrayBuffer();
            return new Uint8Array(arrayBuffer);
        }

        function createICO(images) {
            const headerSize = 6;
            const entrySize = 16;
            const numImages = images.length;
            const dirSize = headerSize + (entrySize * numImages);

            let totalSize = dirSize;
            for (const img of images) {
                totalSize += img.data.length;
            }

            const buffer = new ArrayBuffer(totalSize);
            const view = new DataView(buffer);
            const uint8 = new Uint8Array(buffer);

            view.setUint16(0, 0, true);
            view.setUint16(2, 1, true);
            view.setUint16(4, numImages, true);

            let offset = dirSize;
            for (let i = 0; i < numImages; i++) {
                const img = images[i];
                const entryOffset = headerSize + (i * entrySize);

                view.setUint8(entryOffset + 0, img.size >= 256 ? 0 : img.size);
                view.setUint8(entryOffset + 1, img.size >= 256 ? 0 : img.size);
                view.setUint8(entryOffset + 2, 0);
                view.setUint8(entryOffset + 3, 0);
                view.setUint16(entryOffset + 4, 1, true);
                view.setUint16(entryOffset + 6, 32, true);
                view.setUint32(entryOffset + 8, img.data.length, true);
                view.setUint32(entryOffset + 12, offset, true);

                uint8.set(img.data, offset);
                offset += img.data.length;
            }

            return buffer;
        }

        document.getElementById('sizeGrid').addEventListener('change', () => {
            if (croppedImage) {
                updateSteps(3);
            }
        });

        // FAQ å±•å¼€/æ”¶èµ·åŠŸèƒ½
        function toggleFaq(element) {
            const faqItem = element.parentElement;
            const isActive = faqItem.classList.contains('active');

            // å…³é—­å…¶ä»–å±•å¼€çš„é¡¹
            document.querySelectorAll('.faq-item.active').forEach(item => {
                item.classList.remove('active');
            });

            // å¦‚æœå½“å‰é¡¹æœªå±•å¼€ï¼Œåˆ™å±•å¼€å®ƒ
            if (!isActive) {
                faqItem.classList.add('active');
            }
        }
    </script>

    <!-- FAQ é—®ç­”åŒºå— -->
    <section class="faq-section">
        <h2 class="faq-title"><span data-i18n="faqTitle">â“ FAQ</span></h2>
        <div class="faq-list">
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span data-i18n="faq1Q">What is ICO format used for?</span>
                </div>
                <div class="faq-answer">
                    <div class="faq-answer-content" data-i18n="faq1A">
                        ICO is the Windows icon format, used for desktop shortcuts, website favicons, etc. It can contain multiple icon sizes, and the system will automatically choose the appropriate size to display.
                    </div>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span data-i18n="faq2Q">What image size is recommended?</span>
                </div>
                <div class="faq-answer">
                    <div class="faq-answer-content" data-i18n="faq2A">
                        We recommend using 256x256 or larger square images. The tool will automatically scale to generate various required sizes. Using high-resolution source images ensures quality after scaling.
                    </div>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span data-i18n="faq3Q">Does it support transparent backgrounds?</span>
                </div>
                <div class="faq-answer">
                    <div class="faq-answer-content" data-i18n="faq3A">
                        Yes, upload a PNG image with transparency to preserve the transparent areas. The generated ICO file will maintain the original image's alpha channel.
                    </div>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span data-i18n="faq4Q">What sizes are included in the generated ICO?</span>
                </div>
                <div class="faq-answer">
                    <div class="faq-answer-content" data-i18n="faq4A">
                        It includes common sizes like 16x16, 32x32, 48x48, 64x64, 128x128, 256x256, etc. You can freely select which sizes to include.
                    </div>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span data-i18n="faq5Q">Can it be used for website favicon?</span>
                </div>
                <div class="faq-answer">
                    <div class="faq-answer-content" data-i18n="faq5A">
                        Yes, the generated ICO file can be used directly as a website icon. Name the file favicon.ico and place it in the website root directory for browsers to automatically recognize it.
                    </div>
                </div>
            </div>
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span data-i18n="faq_free_q">Is this tool really free with no ads?</span>
                    <span class="arrow">â–¼</span>
                </div>
                <div class="faq-answer"><p data-i18n="faq_free_a">Yes, 100% free with no ads, no registration, no watermark, and no usage limits. All processing happens locally in your browser â€” your data is never uploaded to any server.</p></div>
            </div>
        </div>
    </section>

    <!-- ç›¸å…³å·¥å…·æ¨è -->
    <section class="related-tools" style="max-width: 900px; margin: 40px auto; padding: 0 20px;">
        <h3 style="color: #e6edf3; font-size: 18px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #30363d;" data-i18n="relatedTools">ğŸ”— Related Tools</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
            <a href="image-compressor.html" style="display: block; padding: 16px; background: #161b22; border: 1px solid #30363d; border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ—œï¸</div>
                <div style="color: #e6edf3; font-weight: 500;" data-i18n="imageCompressor">Image Compressor</div>
                <div style="color: #8b949e; font-size: 12px; margin-top: 4px;" data-i18n="imageCompressorDesc">Compress image file size online</div>
            </a>
            <a href="image-converter.html" style="display: block; padding: 16px; background: #161b22; border: 1px solid #30363d; border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ”„</div>
                <div style="color: #e6edf3; font-weight: 500;" data-i18n="imageConverter">Image Format Converter</div>
                <div style="color: #8b949e; font-size: 12px; margin-top: 4px;" data-i18n="imageConverterDesc">Convert between PNG/JPG/WebP</div>
            </a>
            <a href="image-editor.html" style="display: block; padding: 16px; background: #161b22; border: 1px solid #30363d; border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                <div style="font-size: 24px; margin-bottom: 8px;">âœï¸</div>
                <div style="color: #e6edf3; font-weight: 500;" data-i18n="imageEditor">Image Editor</div>
                <div style="color: #8b949e; font-size: 12px; margin-top: 4px;" data-i18n="imageEditorDesc">Crop, rotate, filters</div>
            </a>
            <a href="id-photo-tool.html" style="display: block; padding: 16px; background: #161b22; border: 1px solid #30363d; border-radius: 8px; text-decoration: none; transition: all 0.2s;">
                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ“·</div>
                <div style="color: #e6edf3; font-weight: 500;" data-i18n="idPhotoTool">ID Photo Maker</div>
                <div style="color: #8b949e; font-size: 12px; margin-top: 4px;" data-i18n="idPhotoToolDesc">Change ID photo background color</div>
            </a>
        </div>
    </section>

    <footer style="text-align: center; padding: 30px 20px; border-top: 1px solid #30363d; color: #8b949e; font-size: 14px;">
        <p data-i18n="footerPrivacy">Pure frontend processing, images are not uploaded to the server</p>
        <p style="margin-top: 12px;">
            <a href="index.html" style="color: #58a6ff; text-decoration: none;" data-i18n="footerBack">â† Back to Web Toolbox</a>
            <span style="margin: 0 12px;">|</span>
            <a href="https://github.com/*****" target="_blank" rel="noopener" style="color: #58a6ff; text-decoration: none;">GitHub</a>
        </p>
    </footer>
</body>
</html>
