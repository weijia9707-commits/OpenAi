{{ define "head" }}
<style>
  .home-wrap{max-width:1040px;margin:2.2rem auto 3rem;padding:0 1rem}
  .hero{position:relative;overflow:hidden;background:linear-gradient(135deg,#0f766e 0%,#14b8a6 35%,#0ea5e9 100%);color:#fff;border-radius:20px;padding:2.2rem 1.6rem;box-shadow:0 10px 30px rgba(2,132,199,.22)}
  .hero::before,.hero::after{content:"";position:absolute;filter:blur(36px);pointer-events:none;opacity:.45}
  .hero::before{width:260px;height:260px;border-radius:50%;background:#67e8f9;top:-90px;left:-60px;animation:floatGlow 11s ease-in-out infinite}
  .hero::after{width:320px;height:320px;border-radius:50%;background:#22d3ee;bottom:-150px;right:-90px;animation:floatGlow 14s ease-in-out infinite reverse}
  @keyframes floatGlow{0%,100%{transform:translate3d(0,0,0)}50%{transform:translate3d(14px,-10px,0)}}
  .hero h1{margin:0 0 .6rem;font-size:2rem;line-height:1.2}
  .hero p{margin:0;opacity:.95}
  .typing-line{display:inline-block;min-height:1.4em}
  .typing-cursor{display:inline-block;width:1px;height:1em;background:rgba(255,255,255,.95);margin-left:3px;vertical-align:-2px;animation:blink 1s steps(1,end) infinite}
  @keyframes blink{50%{opacity:0}}
  .quick{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:12px;margin-top:1rem}
  .quick a{display:block;background:rgba(255,255,255,.14);backdrop-filter: blur(3px);border:1px solid rgba(255,255,255,.25);border-radius:12px;padding:.85rem 1rem;color:#fff;text-decoration:none;font-weight:600;transition:transform .2s ease, box-shadow .2s ease, background .2s ease;will-change:transform}
  .quick a:hover{background:rgba(255,255,255,.22);box-shadow:0 12px 24px rgba(14,165,233,.26)}
  .section-title{margin:1.6rem 0 .8rem;font-size:1.2rem}
  .post-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:14px}
  .post-link{display:block;text-decoration:none;color:inherit;perspective:900px}
  .post-card{position:relative;overflow:hidden;border:1px solid #e6e8eb;border-radius:14px;padding:1rem;background:#fff;transition:transform .22s ease, box-shadow .22s ease, border-color .22s ease, background .22s ease;height:100%;transform-style:preserve-3d;will-change:transform}
  .post-card::before{content:"";position:absolute;inset:-30%;background:radial-gradient(circle at var(--mx,50%) var(--my,50%), rgba(14,165,233,.20), rgba(20,184,166,.10) 35%, rgba(255,255,255,0) 70%);opacity:0;transition:opacity .22s ease;pointer-events:none}
  .post-link:hover .post-card{transform:translateY(-8px) scale(1.01) rotateX(var(--rx,0deg)) rotateY(var(--ry,0deg));box-shadow:0 16px 36px rgba(14,165,233,.18);border-color:rgba(14,165,233,.35);background:linear-gradient(180deg,#fff 0%, #f6fdff 100%)}
  .post-link:hover .post-card::before{opacity:1}
  .post-card h3{margin:.1rem 0 .5rem;font-size:1.06rem;line-height:1.35;color:#111;font-weight:800}
  .post-card p{margin:0;color:#5a6372;font-size:.93rem}
  .post-card .meta{font-size:.82rem;color:#8a93a3;margin-top:.65rem}
  .home-foot{margin:2rem 0 1rem;text-align:center;opacity:.8}
  .reveal{opacity:0;transform:translateY(14px);transition:opacity .55s ease, transform .55s ease}
  .reveal.in{opacity:1;transform:none}
  @media (prefers-reduced-motion: reduce){
    .hero::before,.hero::after{animation:none}
    .post-card,.post-card::before,.quick a,.reveal{transition:none!important}
    .post-link:hover .post-card{transform:none;box-shadow:0 8px 20px rgba(0,0,0,.06)}
  }
  @media (max-width: 860px){
    .quick{grid-template-columns:1fr}
    .post-grid{grid-template-columns:1fr}
    .hero h1{font-size:1.6rem}
  }
</style>
{{ end }}

{{ define "main" }}
  <main class="home-wrap">
    <section class="hero">
      <h1>weijia0707 AI 知识库</h1>
      <p id="heroTyping" class="typing-line" data-text="聚焦 AI使用、AI教程、AI工具。内容持续更新，偏实战、可落地、少废话。">聚焦 AI使用、AI教程、AI工具。内容持续更新，偏实战、可落地、少废话。</p><span id="heroCursor" class="typing-cursor" aria-hidden="true"></span>
      <div class="quick">
        <a href="/categories/ai实战/">AI使用</a>
        <a href="/categories/ai原理/">AI教程</a>
        <a href="/categories/ai工具/">AI工具</a>
        <a href="/games/">休闲娱乐</a>
      </div>
    </section>

    <h2 class="section-title">最新文章</h2>
    <section class="post-grid">
      {{ range first 8 (where .Site.RegularPages "Section" "posts") }}
      <a class="post-link" href="{{ .RelPermalink }}" aria-label="{{ .Title }}">
        <article class="post-card">
          <h3>{{ .Title }}</h3>
          <p>{{ with .Description }}{{ . }}{{ else }}{{ .Summary | plainify | truncate 90 }}{{ end }}</p>
          <div class="meta">{{ .Date.Format "2006-01-02" }}{{ with .Params.categories }} · {{ index . 0 }}{{ end }}</div>
        </article>
      </a>
      {{ end }}
    </section>

    <div class="home-foot">{{ partial "footer.html" . }}</div>
  </main>
  <script>
    (function () {
      const el = document.getElementById('heroTyping');
      const cursor = document.getElementById('heroCursor');
      if (!el) return;
      const key = 'homeHeroTypedV1';
      const text = el.getAttribute('data-text') || '';
      const hasPlayed = localStorage.getItem(key) === '1';

      if (hasPlayed) {
        el.textContent = text;
        if (cursor) cursor.style.display = 'none';
      } else {
        el.textContent = '';
        let i = 0;
        const timer = setInterval(() => {
          i += 1;
          el.textContent = text.slice(0, i);
          if (i >= text.length) {
            clearInterval(timer);
            localStorage.setItem(key, '1');
            if (cursor) setTimeout(() => (cursor.style.display = 'none'), 400);
          }
        }, 40);
      }

      const links = document.querySelectorAll('.post-link');
      links.forEach((link) => {
        const card = link.querySelector('.post-card');
        if (!card) return;

        link.addEventListener('mousemove', (e) => {
          const r = link.getBoundingClientRect();
          const x = e.clientX - r.left;
          const y = e.clientY - r.top;
          const px = (x / r.width) * 100;
          const py = (y / r.height) * 100;
          const ry = ((x - r.width / 2) / r.width) * 6;
          const rx = -((y - r.height / 2) / r.height) * 6;
          card.style.setProperty('--mx', `${px}%`);
          card.style.setProperty('--my', `${py}%`);
          card.style.setProperty('--ry', `${ry.toFixed(2)}deg`);
          card.style.setProperty('--rx', `${rx.toFixed(2)}deg`);
        });

        link.addEventListener('mouseleave', () => {
          card.style.setProperty('--mx', '50%');
          card.style.setProperty('--my', '50%');
          card.style.setProperty('--ry', '0deg');
          card.style.setProperty('--rx', '0deg');
        });
      });

      const quickBtns = document.querySelectorAll('.quick a');
      quickBtns.forEach((btn) => {
        btn.addEventListener('mousemove', (e) => {
          const r = btn.getBoundingClientRect();
          const dx = (e.clientX - (r.left + r.width / 2)) * 0.14;
          const dy = (e.clientY - (r.top + r.height / 2)) * 0.14;
          btn.style.transform = `translate(${dx.toFixed(1)}px, ${dy.toFixed(1)}px)`;
        });
        btn.addEventListener('mouseleave', () => {
          btn.style.transform = 'translate(0,0)';
        });
      });

      const revealTargets = document.querySelectorAll('.section-title, .post-link');
      revealTargets.forEach((el) => el.classList.add('reveal'));
      const io = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) entry.target.classList.add('in');
        });
      }, { threshold: 0.14 });
      revealTargets.forEach((el) => io.observe(el));
    })();
  </script>
{{ end }}
